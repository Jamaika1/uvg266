/*****************************************************************************
 * This file is part of Kvazaar HEVC encoder.
 *
 * Copyright (C) 2013-2015 Tampere University of Technology and others (see
 * COPYING file).
 *
 * Kvazaar is free software: you can redistribute it and/or modify it under
 * the terms of the GNU Lesser General Public License as published by the
 * Free Software Foundation; either version 2.1 of the License, or (at your
 * option) any later version.
 *
 * Kvazaar is distributed in the hope that it will be useful, but WITHOUT ANY
 * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public License for
 * more details.
 *
 * You should have received a copy of the GNU General Public License along
 * with Kvazaar.  If not, see <http://www.gnu.org/licenses/>.
 ****************************************************************************/

#include "strategies/generic/dct-generic.h"

#include "strategyselector.h"
#include "tables.h"

ALIGNED(32) const int16_t kvz_g_dst_4[4][4] =
{
  { 29, 55, 74, 84 },
  { 74, 74, 0, -74 },
  { 84, -29, -74, 55 },
  { 55, -84, 74, -29 }
};

ALIGNED(32) const int16_t kvz_g_dct_2[2][2] =
{
  {64, 64,  },
  {64, -64,  },
};

ALIGNED(32) const int16_t kvz_g_dct_4[4][4] =
{
  { 64, 64, 64, 64 },
  { 83, 36, -36, -83 },
  { 64, -64, -64, 64 },
  { 36, -83, 83, -36 }
};

ALIGNED(64) const int16_t kvz_g_dct_8[8][8] =
{
  { 64, 64, 64, 64, 64, 64, 64, 64 },
  { 89, 75, 50, 18, -18, -50, -75, -89 },
  { 83, 36, -36, -83, -83, -36, 36, 83 },
  { 75, -18, -89, -50, 50, 89, 18, -75 },
  { 64, -64, -64, 64, 64, -64, -64, 64 },
  { 50, -89, 18, 75, -75, -18, 89, -50 },
  { 36, -83, 83, -36, -36, 83, -83, 36 },
  { 18, -50, 75, -89, 89, -75, 50, -18 }
};

ALIGNED(64) const int16_t kvz_g_dct_16[16][16] =
{
  { 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64 },
  { 90, 87, 80, 70, 57, 43, 25, 9, -9, -25, -43, -57, -70, -80, -87, -90 },
  { 89, 75, 50, 18, -18, -50, -75, -89, -89, -75, -50, -18, 18, 50, 75, 89 },
  { 87, 57, 9, -43, -80, -90, -70, -25, 25, 70, 90, 80, 43, -9, -57, -87 },
  { 83, 36, -36, -83, -83, -36, 36, 83, 83, 36, -36, -83, -83, -36, 36, 83 },
  { 80, 9, -70, -87, -25, 57, 90, 43, -43, -90, -57, 25, 87, 70, -9, -80 },
  { 75, -18, -89, -50, 50, 89, 18, -75, -75, 18, 89, 50, -50, -89, -18, 75 },
  { 70, -43, -87, 9, 90, 25, -80, -57, 57, 80, -25, -90, -9, 87, 43, -70 },
  { 64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64 },
  { 57, -80, -25, 90, -9, -87, 43, 70, -70, -43, 87, 9, -90, 25, 80, -57 },
  { 50, -89, 18, 75, -75, -18, 89, -50, -50, 89, -18, -75, 75, 18, -89, 50 },
  { 43, -90, 57, 25, -87, 70, 9, -80, 80, -9, -70, 87, -25, -57, 90, -43 },
  { 36, -83, 83, -36, -36, 83, -83, 36, 36, -83, 83, -36, -36, 83, -83, 36 },
  { 25, -70, 90, -80, 43, 9, -57, 87, -87, 57, -9, -43, 80, -90, 70, -25 },
  { 18, -50, 75, -89, 89, -75, 50, -18, -18, 50, -75, 89, -89, 75, -50, 18 },
  { 9, -25, 43, -57, 70, -80, 87, -90, 90, -87, 80, -70, 57, -43, 25, -9 }
};

ALIGNED(64) const int16_t kvz_g_dct_32[32][32] =
{
  { 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64 },
  { 90, 90, 88, 85, 82, 78, 73, 67, 61, 54, 46, 38, 31, 22, 13, 4, -4, -13, -22, -31, -38, -46, -54, -61, -67, -73, -78, -82, -85, -88, -90, -90 },
  { 90, 87, 80, 70, 57, 43, 25, 9, -9, -25, -43, -57, -70, -80, -87, -90, -90, -87, -80, -70, -57, -43, -25, -9, 9, 25, 43, 57, 70, 80, 87, 90 },
  { 90, 82, 67, 46, 22, -4, -31, -54, -73, -85, -90, -88, -78, -61, -38, -13, 13, 38, 61, 78, 88, 90, 85, 73, 54, 31, 4, -22, -46, -67, -82, -90 },
  { 89, 75, 50, 18, -18, -50, -75, -89, -89, -75, -50, -18, 18, 50, 75, 89, 89, 75, 50, 18, -18, -50, -75, -89, -89, -75, -50, -18, 18, 50, 75, 89 },
  { 88, 67, 31, -13, -54, -82, -90, -78, -46, -4, 38, 73, 90, 85, 61, 22, -22, -61, -85, -90, -73, -38, 4, 46, 78, 90, 82, 54, 13, -31, -67, -88 },
  { 87, 57, 9, -43, -80, -90, -70, -25, 25, 70, 90, 80, 43, -9, -57, -87, -87, -57, -9, 43, 80, 90, 70, 25, -25, -70, -90, -80, -43, 9, 57, 87 },
  { 85, 46, -13, -67, -90, -73, -22, 38, 82, 88, 54, -4, -61, -90, -78, -31, 31, 78, 90, 61, 4, -54, -88, -82, -38, 22, 73, 90, 67, 13, -46, -85 },
  { 83, 36, -36, -83, -83, -36, 36, 83, 83, 36, -36, -83, -83, -36, 36, 83, 83, 36, -36, -83, -83, -36, 36, 83, 83, 36, -36, -83, -83, -36, 36, 83 },
  { 82, 22, -54, -90, -61, 13, 78, 85, 31, -46, -90, -67, 4, 73, 88, 38, -38, -88, -73, -4, 67, 90, 46, -31, -85, -78, -13, 61, 90, 54, -22, -82 },
  { 80, 9, -70, -87, -25, 57, 90, 43, -43, -90, -57, 25, 87, 70, -9, -80, -80, -9, 70, 87, 25, -57, -90, -43, 43, 90, 57, -25, -87, -70, 9, 80 },
  { 78, -4, -82, -73, 13, 85, 67, -22, -88, -61, 31, 90, 54, -38, -90, -46, 46, 90, 38, -54, -90, -31, 61, 88, 22, -67, -85, -13, 73, 82, 4, -78 },
  { 75, -18, -89, -50, 50, 89, 18, -75, -75, 18, 89, 50, -50, -89, -18, 75, 75, -18, -89, -50, 50, 89, 18, -75, -75, 18, 89, 50, -50, -89, -18, 75 },
  { 73, -31, -90, -22, 78, 67, -38, -90, -13, 82, 61, -46, -88, -4, 85, 54, -54, -85, 4, 88, 46, -61, -82, 13, 90, 38, -67, -78, 22, 90, 31, -73 },
  { 70, -43, -87, 9, 90, 25, -80, -57, 57, 80, -25, -90, -9, 87, 43, -70, -70, 43, 87, -9, -90, -25, 80, 57, -57, -80, 25, 90, 9, -87, -43, 70 },
  { 67, -54, -78, 38, 85, -22, -90, 4, 90, 13, -88, -31, 82, 46, -73, -61, 61, 73, -46, -82, 31, 88, -13, -90, -4, 90, 22, -85, -38, 78, 54, -67 },
  { 64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64 },
  { 61, -73, -46, 82, 31, -88, -13, 90, -4, -90, 22, 85, -38, -78, 54, 67, -67, -54, 78, 38, -85, -22, 90, 4, -90, 13, 88, -31, -82, 46, 73, -61 },
  { 57, -80, -25, 90, -9, -87, 43, 70, -70, -43, 87, 9, -90, 25, 80, -57, -57, 80, 25, -90, 9, 87, -43, -70, 70, 43, -87, -9, 90, -25, -80, 57 },
  { 54, -85, -4, 88, -46, -61, 82, 13, -90, 38, 67, -78, -22, 90, -31, -73, 73, 31, -90, 22, 78, -67, -38, 90, -13, -82, 61, 46, -88, 4, 85, -54 },
  { 50, -89, 18, 75, -75, -18, 89, -50, -50, 89, -18, -75, 75, 18, -89, 50, 50, -89, 18, 75, -75, -18, 89, -50, -50, 89, -18, -75, 75, 18, -89, 50 },
  { 46, -90, 38, 54, -90, 31, 61, -88, 22, 67, -85, 13, 73, -82, 4, 78, -78, -4, 82, -73, -13, 85, -67, -22, 88, -61, -31, 90, -54, -38, 90, -46 },
  { 43, -90, 57, 25, -87, 70, 9, -80, 80, -9, -70, 87, -25, -57, 90, -43, -43, 90, -57, -25, 87, -70, -9, 80, -80, 9, 70, -87, 25, 57, -90, 43 },
  { 38, -88, 73, -4, -67, 90, -46, -31, 85, -78, 13, 61, -90, 54, 22, -82, 82, -22, -54, 90, -61, -13, 78, -85, 31, 46, -90, 67, 4, -73, 88, -38 },
  { 36, -83, 83, -36, -36, 83, -83, 36, 36, -83, 83, -36, -36, 83, -83, 36, 36, -83, 83, -36, -36, 83, -83, 36, 36, -83, 83, -36, -36, 83, -83, 36 },
  { 31, -78, 90, -61, 4, 54, -88, 82, -38, -22, 73, -90, 67, -13, -46, 85, -85, 46, 13, -67, 90, -73, 22, 38, -82, 88, -54, -4, 61, -90, 78, -31 },
  { 25, -70, 90, -80, 43, 9, -57, 87, -87, 57, -9, -43, 80, -90, 70, -25, -25, 70, -90, 80, -43, -9, 57, -87, 87, -57, 9, 43, -80, 90, -70, 25 },
  { 22, -61, 85, -90, 73, -38, -4, 46, -78, 90, -82, 54, -13, -31, 67, -88, 88, -67, 31, 13, -54, 82, -90, 78, -46, 4, 38, -73, 90, -85, 61, -22 },
  { 18, -50, 75, -89, 89, -75, 50, -18, -18, 50, -75, 89, -89, 75, -50, 18, 18, -50, 75, -89, 89, -75, 50, -18, -18, 50, -75, 89, -89, 75, -50, 18 },
  { 13, -38, 61, -78, 88, -90, 85, -73, 54, -31, 4, 22, -46, 67, -82, 90, -90, 82, -67, 46, -22, -4, 31, -54, 73, -85, 90, -88, 78, -61, 38, -13 },
  { 9, -25, 43, -57, 70, -80, 87, -90, 90, -87, 80, -70, 57, -43, 25, -9, -9, 25, -43, 57, -70, 80, -87, 90, -90, 87, -80, 70, -57, 43, -25, 9 },
  { 4, -13, 22, -31, 38, -46, 54, -61, 67, -73, 78, -82, 85, -88, 90, -90, 90, -90, 88, -85, 82, -78, 73, -67, 61, -54, 46, -38, 31, -22, 13, -4 }
};

ALIGNED(64) const int16_t kvz_g_dct_64[64][64] =
{
   { 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, },
   { 91, 90, 90, 90, 88, 87, 86, 84, 83, 81, 79, 77, 73, 71, 69, 65, 62, 59, 56, 52, 48, 44, 41, 37, 33, 28, 24, 20, 15, 11, 7, 2, -2, -7, -11, -15, -20, -24, -28, -33, -37, -41, -44, -48, -52, -56, -59, -62, -65, -69, -71, -73, -77, -79, -81, -83, -84, -86, -87, -88, -90, -90, -90, -91, },
   { 90, 90, 88, 85, 82, 78, 73, 67, 61, 54, 46, 38, 31, 22, 13, 4, -4, -13, -22, -31, -38, -46, -54, -61, -67, -73, -78, -82, -85, -88, -90, -90, -90, -90, -88, -85, -82, -78, -73, -67, -61, -54, -46, -38, -31, -22, -13, -4, 4, 13, 22, 31, 38, 46, 54, 61, 67, 73, 78, 82, 85, 88, 90, 90, },
   { 90, 88, 84, 79, 71, 62, 52, 41, 28, 15, 2, -11, -24, -37, -48, -59, -69, -77, -83, -87, -90, -91, -90, -86, -81, -73, -65, -56, -44, -33, -20, -7, 7, 20, 33, 44, 56, 65, 73, 81, 86, 90, 91, 90, 87, 83, 77, 69, 59, 48, 37, 24, 11, -2, -15, -28, -41, -52, -62, -71, -79, -84, -88, -90, },
   { 90, 87, 80, 70, 57, 43, 25, 9, -9, -25, -43, -57, -70, -80, -87, -90, -90, -87, -80, -70, -57, -43, -25, -9, 9, 25, 43, 57, 70, 80, 87, 90, 90, 87, 80, 70, 57, 43, 25, 9, -9, -25, -43, -57, -70, -80, -87, -90, -90, -87, -80, -70, -57, -43, -25, -9, 9, 25, 43, 57, 70, 80, 87, 90, },
   { 90, 84, 73, 59, 41, 20, -2, -24, -44, -62, -77, -86, -90, -90, -83, -71, -56, -37, -15, 7, 28, 48, 65, 79, 87, 91, 88, 81, 69, 52, 33, 11, -11, -33, -52, -69, -81, -88, -91, -87, -79, -65, -48, -28, -7, 15, 37, 56, 71, 83, 90, 90, 86, 77, 62, 44, 24, 2, -20, -41, -59, -73, -84, -90, },
   { 90, 82, 67, 46, 22, -4, -31, -54, -73, -85, -90, -88, -78, -61, -38, -13, 13, 38, 61, 78, 88, 90, 85, 73, 54, 31, 4, -22, -46, -67, -82, -90, -90, -82, -67, -46, -22, 4, 31, 54, 73, 85, 90, 88, 78, 61, 38, 13, -13, -38, -61, -78, -88, -90, -85, -73, -54, -31, -4, 22, 46, 67, 82, 90, },
   { 90, 79, 59, 33, 2, -28, -56, -77, -88, -90, -81, -62, -37, -7, 24, 52, 73, 87, 90, 83, 65, 41, 11, -20, -48, -71, -86, -91, -84, -69, -44, -15, 15, 44, 69, 84, 91, 86, 71, 48, 20, -11, -41, -65, -83, -90, -87, -73, -52, -24, 7, 37, 62, 81, 90, 88, 77, 56, 28, -2, -33, -59, -79, -90, },
   { 89, 75, 50, 18, -18, -50, -75, -89, -89, -75, -50, -18, 18, 50, 75, 89, 89, 75, 50, 18, -18, -50, -75, -89, -89, -75, -50, -18, 18, 50, 75, 89, 89, 75, 50, 18, -18, -50, -75, -89, -89, -75, -50, -18, 18, 50, 75, 89, 89, 75, 50, 18, -18, -50, -75, -89, -89, -75, -50, -18, 18, 50, 75, 89, },
   { 88, 71, 41, 2, -37, -69, -87, -90, -73, -44, -7, 33, 65, 86, 90, 77, 48, 11, -28, -62, -84, -90, -79, -52, -15, 24, 59, 83, 91, 81, 56, 20, -20, -56, -81, -91, -83, -59, -24, 15, 52, 79, 90, 84, 62, 28, -11, -48, -77, -90, -86, -65, -33, 7, 44, 73, 90, 87, 69, 37, -2, -41, -71, -88, },
   { 88, 67, 31, -13, -54, -82, -90, -78, -46, -4, 38, 73, 90, 85, 61, 22, -22, -61, -85, -90, -73, -38, 4, 46, 78, 90, 82, 54, 13, -31, -67, -88, -88, -67, -31, 13, 54, 82, 90, 78, 46, 4, -38, -73, -90, -85, -61, -22, 22, 61, 85, 90, 73, 38, -4, -46, -78, -90, -82, -54, -13, 31, 67, 88, },
   { 87, 62, 20, -28, -69, -90, -84, -56, -11, 37, 73, 90, 81, 48, 2, -44, -79, -91, -77, -41, 7, 52, 83, 90, 71, 33, -15, -59, -86, -88, -65, -24, 24, 65, 88, 86, 59, 15, -33, -71, -90, -83, -52, -7, 41, 77, 91, 79, 44, -2, -48, -81, -90, -73, -37, 11, 56, 84, 90, 69, 28, -20, -62, -87, },
   { 87, 57, 9, -43, -80, -90, -70, -25, 25, 70, 90, 80, 43, -9, -57, -87, -87, -57, -9, 43, 80, 90, 70, 25, -25, -70, -90, -80, -43, 9, 57, 87, 87, 57, 9, -43, -80, -90, -70, -25, 25, 70, 90, 80, 43, -9, -57, -87, -87, -57, -9, 43, 80, 90, 70, 25, -25, -70, -90, -80, -43, 9, 57, 87, },
   { 86, 52, -2, -56, -87, -84, -48, 7, 59, 88, 83, 44, -11, -62, -90, -81, -41, 15, 65, 90, 79, 37, -20, -69, -90, -77, -33, 24, 71, 91, 73, 28, -28, -73, -91, -71, -24, 33, 77, 90, 69, 20, -37, -79, -90, -65, -15, 41, 81, 90, 62, 11, -44, -83, -88, -59, -7, 48, 84, 87, 56, 2, -52, -86, },
   { 85, 46, -13, -67, -90, -73, -22, 38, 82, 88, 54, -4, -61, -90, -78, -31, 31, 78, 90, 61, 4, -54, -88, -82, -38, 22, 73, 90, 67, 13, -46, -85, -85, -46, 13, 67, 90, 73, 22, -38, -82, -88, -54, 4, 61, 90, 78, 31, -31, -78, -90, -61, -4, 54, 88, 82, 38, -22, -73, -90, -67, -13, 46, 85, },
   { 84, 41, -24, -77, -90, -56, 7, 65, 91, 69, 11, -52, -88, -79, -28, 37, 83, 86, 44, -20, -73, -90, -59, 2, 62, 90, 71, 15, -48, -87, -81, -33, 33, 81, 87, 48, -15, -71, -90, -62, -2, 59, 90, 73, 20, -44, -86, -83, -37, 28, 79, 88, 52, -11, -69, -91, -65, -7, 56, 90, 77, 24, -41, -84, },
   { 83, 36, -36, -83, -83, -36, 36, 83, 83, 36, -36, -83, -83, -36, 36, 83, 83, 36, -36, -83, -83, -36, 36, 83, 83, 36, -36, -83, -83, -36, 36, 83, 83, 36, -36, -83, -83, -36, 36, 83, 83, 36, -36, -83, -83, -36, 36, 83, 83, 36, -36, -83, -83, -36, 36, 83, 83, 36, -36, -83, -83, -36, 36, 83, },
   { 83, 28, -44, -88, -73, -11, 59, 91, 62, -7, -71, -90, -48, 24, 81, 84, 33, -41, -87, -77, -15, 56, 90, 65, -2, -69, -90, -52, 20, 79, 86, 37, -37, -86, -79, -20, 52, 90, 69, 2, -65, -90, -56, 15, 77, 87, 41, -33, -84, -81, -24, 48, 90, 71, 7, -62, -91, -59, 11, 73, 88, 44, -28, -83, },
   { 82, 22, -54, -90, -61, 13, 78, 85, 31, -46, -90, -67, 4, 73, 88, 38, -38, -88, -73, -4, 67, 90, 46, -31, -85, -78, -13, 61, 90, 54, -22, -82, -82, -22, 54, 90, 61, -13, -78, -85, -31, 46, 90, 67, -4, -73, -88, -38, 38, 88, 73, 4, -67, -90, -46, 31, 85, 78, 13, -61, -90, -54, 22, 82, },
   { 81, 15, -62, -90, -44, 37, 88, 69, -7, -77, -84, -24, 56, 91, 52, -28, -86, -73, -2, 71, 87, 33, -48, -90, -59, 20, 83, 79, 11, -65, -90, -41, 41, 90, 65, -11, -79, -83, -20, 59, 90, 48, -33, -87, -71, 2, 73, 86, 28, -52, -91, -56, 24, 84, 77, 7, -69, -88, -37, 44, 90, 62, -15, -81, },
   { 80, 9, -70, -87, -25, 57, 90, 43, -43, -90, -57, 25, 87, 70, -9, -80, -80, -9, 70, 87, 25, -57, -90, -43, 43, 90, 57, -25, -87, -70, 9, 80, 80, 9, -70, -87, -25, 57, 90, 43, -43, -90, -57, 25, 87, 70, -9, -80, -80, -9, 70, 87, 25, -57, -90, -43, 43, 90, 57, -25, -87, -70, 9, 80, },
   { 79, 2, -77, -81, -7, 73, 83, 11, -71, -84, -15, 69, 86, 20, -65, -87, -24, 62, 88, 28, -59, -90, -33, 56, 90, 37, -52, -90, -41, 48, 91, 44, -44, -91, -48, 41, 90, 52, -37, -90, -56, 33, 90, 59, -28, -88, -62, 24, 87, 65, -20, -86, -69, 15, 84, 71, -11, -83, -73, 7, 81, 77, -2, -79, },
   { 78, -4, -82, -73, 13, 85, 67, -22, -88, -61, 31, 90, 54, -38, -90, -46, 46, 90, 38, -54, -90, -31, 61, 88, 22, -67, -85, -13, 73, 82, 4, -78, -78, 4, 82, 73, -13, -85, -67, 22, 88, 61, -31, -90, -54, 38, 90, 46, -46, -90, -38, 54, 90, 31, -61, -88, -22, 67, 85, 13, -73, -82, -4, 78, },
   { 77, -11, -86, -62, 33, 90, 44, -52, -90, -24, 69, 83, 2, -81, -71, 20, 88, 56, -41, -91, -37, 59, 87, 15, -73, -79, 7, 84, 65, -28, -90, -48, 48, 90, 28, -65, -84, -7, 79, 73, -15, -87, -59, 37, 91, 41, -56, -88, -20, 71, 81, -2, -83, -69, 24, 90, 52, -44, -90, -33, 62, 86, 11, -77, },
   { 75, -18, -89, -50, 50, 89, 18, -75, -75, 18, 89, 50, -50, -89, -18, 75, 75, -18, -89, -50, 50, 89, 18, -75, -75, 18, 89, 50, -50, -89, -18, 75, 75, -18, -89, -50, 50, 89, 18, -75, -75, 18, 89, 50, -50, -89, -18, 75, 75, -18, -89, -50, 50, 89, 18, -75, -75, 18, 89, 50, -50, -89, -18, 75, },
   { 73, -24, -90, -37, 65, 81, -11, -88, -48, 56, 86, 2, -84, -59, 44, 90, 15, -79, -69, 33, 91, 28, -71, -77, 20, 90, 41, -62, -83, 7, 87, 52, -52, -87, -7, 83, 62, -41, -90, -20, 77, 71, -28, -91, -33, 69, 79, -15, -90, -44, 59, 84, -2, -86, -56, 48, 88, 11, -81, -65, 37, 90, 24, -73, },
   { 73, -31, -90, -22, 78, 67, -38, -90, -13, 82, 61, -46, -88, -4, 85, 54, -54, -85, 4, 88, 46, -61, -82, 13, 90, 38, -67, -78, 22, 90, 31, -73, -73, 31, 90, 22, -78, -67, 38, 90, 13, -82, -61, 46, 88, 4, -85, -54, 54, 85, -4, -88, -46, 61, 82, -13, -90, -38, 67, 78, -22, -90, -31, 73, },
   { 71, -37, -90, -7, 86, 48, -62, -79, 24, 91, 20, -81, -59, 52, 84, -11, -90, -33, 73, 69, -41, -88, -2, 87, 44, -65, -77, 28, 90, 15, -83, -56, 56, 83, -15, -90, -28, 77, 65, -44, -87, 2, 88, 41, -69, -73, 33, 90, 11, -84, -52, 59, 81, -20, -91, -24, 79, 62, -48, -86, 7, 90, 37, -71, },
   { 70, -43, -87, 9, 90, 25, -80, -57, 57, 80, -25, -90, -9, 87, 43, -70, -70, 43, 87, -9, -90, -25, 80, 57, -57, -80, 25, 90, 9, -87, -43, 70, 70, -43, -87, 9, 90, 25, -80, -57, 57, 80, -25, -90, -9, 87, 43, -70, -70, 43, 87, -9, -90, -25, 80, 57, -57, -80, 25, 90, 9, -87, -43, 70, },
   { 69, -48, -83, 24, 90, 2, -90, -28, 81, 52, -65, -71, 44, 84, -20, -90, -7, 88, 33, -79, -56, 62, 73, -41, -86, 15, 91, 11, -87, -37, 77, 59, -59, -77, 37, 87, -11, -91, -15, 86, 41, -73, -62, 56, 79, -33, -88, 7, 90, 20, -84, -44, 71, 65, -52, -81, 28, 90, -2, -90, -24, 83, 48, -69, },
   { 67, -54, -78, 38, 85, -22, -90, 4, 90, 13, -88, -31, 82, 46, -73, -61, 61, 73, -46, -82, 31, 88, -13, -90, -4, 90, 22, -85, -38, 78, 54, -67, -67, 54, 78, -38, -85, 22, 90, -4, -90, -13, 88, 31, -82, -46, 73, 61, -61, -73, 46, 82, -31, -88, 13, 90, 4, -90, -22, 85, 38, -78, -54, 67, },
   { 65, -59, -71, 52, 77, -44, -81, 37, 84, -28, -87, 20, 90, -11, -90, 2, 91, 7, -90, -15, 88, 24, -86, -33, 83, 41, -79, -48, 73, 56, -69, -62, 62, 69, -56, -73, 48, 79, -41, -83, 33, 86, -24, -88, 15, 90, -7, -91, -2, 90, 11, -90, -20, 87, 28, -84, -37, 81, 44, -77, -52, 71, 59, -65, },
   { 64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64, },
   { 62, -69, -56, 73, 48, -79, -41, 83, 33, -86, -24, 88, 15, -90, -7, 91, -2, -90, 11, 90, -20, -87, 28, 84, -37, -81, 44, 77, -52, -71, 59, 65, -65, -59, 71, 52, -77, -44, 81, 37, -84, -28, 87, 20, -90, -11, 90, 2, -91, 7, 90, -15, -88, 24, 86, -33, -83, 41, 79, -48, -73, 56, 69, -62, },
   { 61, -73, -46, 82, 31, -88, -13, 90, -4, -90, 22, 85, -38, -78, 54, 67, -67, -54, 78, 38, -85, -22, 90, 4, -90, 13, 88, -31, -82, 46, 73, -61, -61, 73, 46, -82, -31, 88, 13, -90, 4, 90, -22, -85, 38, 78, -54, -67, 67, 54, -78, -38, 85, 22, -90, -4, 90, -13, -88, 31, 82, -46, -73, 61, },
   { 59, -77, -37, 87, 11, -91, 15, 86, -41, -73, 62, 56, -79, -33, 88, 7, -90, 20, 84, -44, -71, 65, 52, -81, -28, 90, 2, -90, 24, 83, -48, -69, 69, 48, -83, -24, 90, -2, -90, 28, 81, -52, -65, 71, 44, -84, -20, 90, -7, -88, 33, 79, -56, -62, 73, 41, -86, -15, 91, -11, -87, 37, 77, -59, },
   { 57, -80, -25, 90, -9, -87, 43, 70, -70, -43, 87, 9, -90, 25, 80, -57, -57, 80, 25, -90, 9, 87, -43, -70, 70, 43, -87, -9, 90, -25, -80, 57, 57, -80, -25, 90, -9, -87, 43, 70, -70, -43, 87, 9, -90, 25, 80, -57, -57, 80, 25, -90, 9, 87, -43, -70, 70, 43, -87, -9, 90, -25, -80, 57, },
   { 56, -83, -15, 90, -28, -77, 65, 44, -87, -2, 88, -41, -69, 73, 33, -90, 11, 84, -52, -59, 81, 20, -91, 24, 79, -62, -48, 86, 7, -90, 37, 71, -71, -37, 90, -7, -86, 48, 62, -79, -24, 91, -20, -81, 59, 52, -84, -11, 90, -33, -73, 69, 41, -88, 2, 87, -44, -65, 77, 28, -90, 15, 83, -56, },
   { 54, -85, -4, 88, -46, -61, 82, 13, -90, 38, 67, -78, -22, 90, -31, -73, 73, 31, -90, 22, 78, -67, -38, 90, -13, -82, 61, 46, -88, 4, 85, -54, -54, 85, 4, -88, 46, 61, -82, -13, 90, -38, -67, 78, 22, -90, 31, 73, -73, -31, 90, -22, -78, 67, 38, -90, 13, 82, -61, -46, 88, -4, -85, 54, },
   { 52, -87, 7, 83, -62, -41, 90, -20, -77, 71, 28, -91, 33, 69, -79, -15, 90, -44, -59, 84, 2, -86, 56, 48, -88, 11, 81, -65, -37, 90, -24, -73, 73, 24, -90, 37, 65, -81, -11, 88, -48, -56, 86, -2, -84, 59, 44, -90, 15, 79, -69, -33, 91, -28, -71, 77, 20, -90, 41, 62, -83, -7, 87, -52, },
   { 50, -89, 18, 75, -75, -18, 89, -50, -50, 89, -18, -75, 75, 18, -89, 50, 50, -89, 18, 75, -75, -18, 89, -50, -50, 89, -18, -75, 75, 18, -89, 50, 50, -89, 18, 75, -75, -18, 89, -50, -50, 89, -18, -75, 75, 18, -89, 50, 50, -89, 18, 75, -75, -18, 89, -50, -50, 89, -18, -75, 75, 18, -89, 50, },
   { 48, -90, 28, 65, -84, 7, 79, -73, -15, 87, -59, -37, 91, -41, -56, 88, -20, -71, 81, 2, -83, 69, 24, -90, 52, 44, -90, 33, 62, -86, 11, 77, -77, -11, 86, -62, -33, 90, -44, -52, 90, -24, -69, 83, -2, -81, 71, 20, -88, 56, 41, -91, 37, 59, -87, 15, 73, -79, -7, 84, -65, -28, 90, -48, },
   { 46, -90, 38, 54, -90, 31, 61, -88, 22, 67, -85, 13, 73, -82, 4, 78, -78, -4, 82, -73, -13, 85, -67, -22, 88, -61, -31, 90, -54, -38, 90, -46, -46, 90, -38, -54, 90, -31, -61, 88, -22, -67, 85, -13, -73, 82, -4, -78, 78, 4, -82, 73, 13, -85, 67, 22, -88, 61, 31, -90, 54, 38, -90, 46, },
   { 44, -91, 48, 41, -90, 52, 37, -90, 56, 33, -90, 59, 28, -88, 62, 24, -87, 65, 20, -86, 69, 15, -84, 71, 11, -83, 73, 7, -81, 77, 2, -79, 79, -2, -77, 81, -7, -73, 83, -11, -71, 84, -15, -69, 86, -20, -65, 87, -24, -62, 88, -28, -59, 90, -33, -56, 90, -37, -52, 90, -41, -48, 91, -44, },
   { 43, -90, 57, 25, -87, 70, 9, -80, 80, -9, -70, 87, -25, -57, 90, -43, -43, 90, -57, -25, 87, -70, -9, 80, -80, 9, 70, -87, 25, 57, -90, 43, 43, -90, 57, 25, -87, 70, 9, -80, 80, -9, -70, 87, -25, -57, 90, -43, -43, 90, -57, -25, 87, -70, -9, 80, -80, 9, 70, -87, 25, 57, -90, 43, },
   { 41, -90, 65, 11, -79, 83, -20, -59, 90, -48, -33, 87, -71, -2, 73, -86, 28, 52, -91, 56, 24, -84, 77, -7, -69, 88, -37, -44, 90, -62, -15, 81, -81, 15, 62, -90, 44, 37, -88, 69, 7, -77, 84, -24, -56, 91, -52, -28, 86, -73, 2, 71, -87, 33, 48, -90, 59, 20, -83, 79, -11, -65, 90, -41, },
   { 38, -88, 73, -4, -67, 90, -46, -31, 85, -78, 13, 61, -90, 54, 22, -82, 82, -22, -54, 90, -61, -13, 78, -85, 31, 46, -90, 67, 4, -73, 88, -38, -38, 88, -73, 4, 67, -90, 46, 31, -85, 78, -13, -61, 90, -54, -22, 82, -82, 22, 54, -90, 61, 13, -78, 85, -31, -46, 90, -67, -4, 73, -88, 38, },
   { 37, -86, 79, -20, -52, 90, -69, 2, 65, -90, 56, 15, -77, 87, -41, -33, 84, -81, 24, 48, -90, 71, -7, -62, 91, -59, -11, 73, -88, 44, 28, -83, 83, -28, -44, 88, -73, 11, 59, -91, 62, 7, -71, 90, -48, -24, 81, -84, 33, 41, -87, 77, -15, -56, 90, -65, -2, 69, -90, 52, 20, -79, 86, -37, },
   { 36, -83, 83, -36, -36, 83, -83, 36, 36, -83, 83, -36, -36, 83, -83, 36, 36, -83, 83, -36, -36, 83, -83, 36, 36, -83, 83, -36, -36, 83, -83, 36, 36, -83, 83, -36, -36, 83, -83, 36, 36, -83, 83, -36, -36, 83, -83, 36, 36, -83, 83, -36, -36, 83, -83, 36, 36, -83, 83, -36, -36, 83, -83, 36, },
   { 33, -81, 87, -48, -15, 71, -90, 62, -2, -59, 90, -73, 20, 44, -86, 83, -37, -28, 79, -88, 52, 11, -69, 91, -65, 7, 56, -90, 77, -24, -41, 84, -84, 41, 24, -77, 90, -56, -7, 65, -91, 69, -11, -52, 88, -79, 28, 37, -83, 86, -44, -20, 73, -90, 59, 2, -62, 90, -71, 15, 48, -87, 81, -33, },
   { 31, -78, 90, -61, 4, 54, -88, 82, -38, -22, 73, -90, 67, -13, -46, 85, -85, 46, 13, -67, 90, -73, 22, 38, -82, 88, -54, -4, 61, -90, 78, -31, -31, 78, -90, 61, -4, -54, 88, -82, 38, 22, -73, 90, -67, 13, 46, -85, 85, -46, -13, 67, -90, 73, -22, -38, 82, -88, 54, 4, -61, 90, -78, 31, },
   { 28, -73, 91, -71, 24, 33, -77, 90, -69, 20, 37, -79, 90, -65, 15, 41, -81, 90, -62, 11, 44, -83, 88, -59, 7, 48, -84, 87, -56, 2, 52, -86, 86, -52, -2, 56, -87, 84, -48, -7, 59, -88, 83, -44, -11, 62, -90, 81, -41, -15, 65, -90, 79, -37, -20, 69, -90, 77, -33, -24, 71, -91, 73, -28, },
   { 25, -70, 90, -80, 43, 9, -57, 87, -87, 57, -9, -43, 80, -90, 70, -25, -25, 70, -90, 80, -43, -9, 57, -87, 87, -57, 9, 43, -80, 90, -70, 25, 25, -70, 90, -80, 43, 9, -57, 87, -87, 57, -9, -43, 80, -90, 70, -25, -25, 70, -90, 80, -43, -9, 57, -87, 87, -57, 9, 43, -80, 90, -70, 25, },
   { 24, -65, 88, -86, 59, -15, -33, 71, -90, 83, -52, 7, 41, -77, 91, -79, 44, 2, -48, 81, -90, 73, -37, -11, 56, -84, 90, -69, 28, 20, -62, 87, -87, 62, -20, -28, 69, -90, 84, -56, 11, 37, -73, 90, -81, 48, -2, -44, 79, -91, 77, -41, -7, 52, -83, 90, -71, 33, 15, -59, 86, -88, 65, -24, },
   { 22, -61, 85, -90, 73, -38, -4, 46, -78, 90, -82, 54, -13, -31, 67, -88, 88, -67, 31, 13, -54, 82, -90, 78, -46, 4, 38, -73, 90, -85, 61, -22, -22, 61, -85, 90, -73, 38, 4, -46, 78, -90, 82, -54, 13, 31, -67, 88, -88, 67, -31, -13, 54, -82, 90, -78, 46, -4, -38, 73, -90, 85, -61, 22, },
   { 20, -56, 81, -91, 83, -59, 24, 15, -52, 79, -90, 84, -62, 28, 11, -48, 77, -90, 86, -65, 33, 7, -44, 73, -90, 87, -69, 37, 2, -41, 71, -88, 88, -71, 41, -2, -37, 69, -87, 90, -73, 44, -7, -33, 65, -86, 90, -77, 48, -11, -28, 62, -84, 90, -79, 52, -15, -24, 59, -83, 91, -81, 56, -20, },
   { 18, -50, 75, -89, 89, -75, 50, -18, -18, 50, -75, 89, -89, 75, -50, 18, 18, -50, 75, -89, 89, -75, 50, -18, -18, 50, -75, 89, -89, 75, -50, 18, 18, -50, 75, -89, 89, -75, 50, -18, -18, 50, -75, 89, -89, 75, -50, 18, 18, -50, 75, -89, 89, -75, 50, -18, -18, 50, -75, 89, -89, 75, -50, 18, },
   { 15, -44, 69, -84, 91, -86, 71, -48, 20, 11, -41, 65, -83, 90, -87, 73, -52, 24, 7, -37, 62, -81, 90, -88, 77, -56, 28, 2, -33, 59, -79, 90, -90, 79, -59, 33, -2, -28, 56, -77, 88, -90, 81, -62, 37, -7, -24, 52, -73, 87, -90, 83, -65, 41, -11, -20, 48, -71, 86, -91, 84, -69, 44, -15, },
   { 13, -38, 61, -78, 88, -90, 85, -73, 54, -31, 4, 22, -46, 67, -82, 90, -90, 82, -67, 46, -22, -4, 31, -54, 73, -85, 90, -88, 78, -61, 38, -13, -13, 38, -61, 78, -88, 90, -85, 73, -54, 31, -4, -22, 46, -67, 82, -90, 90, -82, 67, -46, 22, 4, -31, 54, -73, 85, -90, 88, -78, 61, -38, 13, },
   { 11, -33, 52, -69, 81, -88, 91, -87, 79, -65, 48, -28, 7, 15, -37, 56, -71, 83, -90, 90, -86, 77, -62, 44, -24, 2, 20, -41, 59, -73, 84, -90, 90, -84, 73, -59, 41, -20, -2, 24, -44, 62, -77, 86, -90, 90, -83, 71, -56, 37, -15, -7, 28, -48, 65, -79, 87, -91, 88, -81, 69, -52, 33, -11, },
   { 9, -25, 43, -57, 70, -80, 87, -90, 90, -87, 80, -70, 57, -43, 25, -9, -9, 25, -43, 57, -70, 80, -87, 90, -90, 87, -80, 70, -57, 43, -25, 9, 9, -25, 43, -57, 70, -80, 87, -90, 90, -87, 80, -70, 57, -43, 25, -9, -9, 25, -43, 57, -70, 80, -87, 90, -90, 87, -80, 70, -57, 43, -25, 9, },
   { 7, -20, 33, -44, 56, -65, 73, -81, 86, -90, 91, -90, 87, -83, 77, -69, 59, -48, 37, -24, 11, 2, -15, 28, -41, 52, -62, 71, -79, 84, -88, 90, -90, 88, -84, 79, -71, 62, -52, 41, -28, 15, -2, -11, 24, -37, 48, -59, 69, -77, 83, -87, 90, -91, 90, -86, 81, -73, 65, -56, 44, -33, 20, -7, },
   { 4, -13, 22, -31, 38, -46, 54, -61, 67, -73, 78, -82, 85, -88, 90, -90, 90, -90, 88, -85, 82, -78, 73, -67, 61, -54, 46, -38, 31, -22, 13, -4, -4, 13, -22, 31, -38, 46, -54, 61, -67, 73, -78, 82, -85, 88, -90, 90, -90, 90, -88, 85, -82, 78, -73, 67, -61, 54, -46, 38, -31, 22, -13, 4, },
   { 2, -7, 11, -15, 20, -24, 28, -33, 37, -41, 44, -48, 52, -56, 59, -62, 65, -69, 71, -73, 77, -79, 81, -83, 84, -86, 87, -88, 90, -90, 90, -91, 91, -90, 90, -90, 88, -87, 86, -84, 83, -81, 79, -77, 73, -71, 69, -65, 62, -59, 56, -52, 48, -44, 41, -37, 33, -28, 24, -20, 15, -11, 7, -2, },
};

ALIGNED(64) const int16_t kvz_g_dst_4_t[4][4] =
{
  { 29, 74, 84, 55 },
  { 55, 74, -29, -84 },
  { 74, 0, -74, 74 },
  { 84, -74, 55, -29 }
};

ALIGNED(32) const int16_t kvz_g_dct_4_t[4][4] =
{
  { 64, 83, 64, 36, },
  { 64, 36, -64, -83, },
  { 64, -36, -64, 83, },
  { 64, -83, 64, -36 }
};

ALIGNED(64) const int16_t kvz_g_dct_8_t[8][8] =
{
  { 64, 89, 83, 75, 64, 50, 36, 18, },
  { 64, 75, 36, -18, -64, -89, -83, -50, },
  { 64, 50, -36, -89, -64, 18, 83, 75, },
  { 64, 18, -83, -50, 64, 75, -36, -89, },
  { 64, -18, -83, 50, 64, -75, -36, 89, },
  { 64, -50, -36, 89, -64, -18, 83, -75, },
  { 64, -75, 36, 18, -64, 89, -83, 50, },
  { 64, -89, 83, -75, 64, -50, 36, -18 }
};

ALIGNED(64) const int16_t kvz_g_dct_16_t[16][16] =
{
  { 64, 90, 89, 87, 83, 80, 75, 70, 64, 57, 50, 43, 36, 25, 18, 9, },
  { 64, 87, 75, 57, 36, 9, -18, -43, -64, -80, -89, -90, -83, -70, -50, -25, },
  { 64, 80, 50, 9, -36, -70, -89, -87, -64, -25, 18, 57, 83, 90, 75, 43, },
  { 64, 70, 18, -43, -83, -87, -50, 9, 64, 90, 75, 25, -36, -80, -89, -57, },
  { 64, 57, -18, -80, -83, -25, 50, 90, 64, -9, -75, -87, -36, 43, 89, 70, },
  { 64, 43, -50, -90, -36, 57, 89, 25, -64, -87, -18, 70, 83, 9, -75, -80, },
  { 64, 25, -75, -70, 36, 90, 18, -80, -64, 43, 89, 9, -83, -57, 50, 87, },
  { 64, 9, -89, -25, 83, 43, -75, -57, 64, 70, -50, -80, 36, 87, -18, -90, },
  { 64, -9, -89, 25, 83, -43, -75, 57, 64, -70, -50, 80, 36, -87, -18, 90, },
  { 64, -25, -75, 70, 36, -90, 18, 80, -64, -43, 89, -9, -83, 57, 50, -87, },
  { 64, -43, -50, 90, -36, -57, 89, -25, -64, 87, -18, -70, 83, -9, -75, 80, },
  { 64, -57, -18, 80, -83, 25, 50, -90, 64, 9, -75, 87, -36, -43, 89, -70, },
  { 64, -70, 18, 43, -83, 87, -50, -9, 64, -90, 75, -25, -36, 80, -89, 57, },
  { 64, -80, 50, -9, -36, 70, -89, 87, -64, 25, 18, -57, 83, -90, 75, -43, },
  { 64, -87, 75, -57, 36, -9, -18, 43, -64, 80, -89, 90, -83, 70, -50, 25, },
  { 64, -90, 89, -87, 83, -80, 75, -70, 64, -57, 50, -43, 36, -25, 18, -9 }
};

ALIGNED(64) const int16_t kvz_g_dct_32_t[32][32] =
{
  { 64, 90, 90, 90, 89, 88, 87, 85, 83, 82, 80, 78, 75, 73, 70, 67, 64, 61, 57, 54, 50, 46, 43, 38, 36, 31, 25, 22, 18, 13, 9, 4, },
  { 64, 90, 87, 82, 75, 67, 57, 46, 36, 22, 9, -4, -18, -31, -43, -54, -64, -73, -80, -85, -89, -90, -90, -88, -83, -78, -70, -61, -50, -38, -25, -13, },
  { 64, 88, 80, 67, 50, 31, 9, -13, -36, -54, -70, -82, -89, -90, -87, -78, -64, -46, -25, -4, 18, 38, 57, 73, 83, 90, 90, 85, 75, 61, 43, 22, },
  { 64, 85, 70, 46, 18, -13, -43, -67, -83, -90, -87, -73, -50, -22, 9, 38, 64, 82, 90, 88, 75, 54, 25, -4, -36, -61, -80, -90, -89, -78, -57, -31, },
  { 64, 82, 57, 22, -18, -54, -80, -90, -83, -61, -25, 13, 50, 78, 90, 85, 64, 31, -9, -46, -75, -90, -87, -67, -36, 4, 43, 73, 89, 88, 70, 38, },
  { 64, 78, 43, -4, -50, -82, -90, -73, -36, 13, 57, 85, 89, 67, 25, -22, -64, -88, -87, -61, -18, 31, 70, 90, 83, 54, 9, -38, -75, -90, -80, -46, },
  { 64, 73, 25, -31, -75, -90, -70, -22, 36, 78, 90, 67, 18, -38, -80, -90, -64, -13, 43, 82, 89, 61, 9, -46, -83, -88, -57, -4, 50, 85, 87, 54, },
  { 64, 67, 9, -54, -89, -78, -25, 38, 83, 85, 43, -22, -75, -90, -57, 4, 64, 90, 70, 13, -50, -88, -80, -31, 36, 82, 87, 46, -18, -73, -90, -61, },
  { 64, 61, -9, -73, -89, -46, 25, 82, 83, 31, -43, -88, -75, -13, 57, 90, 64, -4, -70, -90, -50, 22, 80, 85, 36, -38, -87, -78, -18, 54, 90, 67, },
  { 64, 54, -25, -85, -75, -4, 70, 88, 36, -46, -90, -61, 18, 82, 80, 13, -64, -90, -43, 38, 89, 67, -9, -78, -83, -22, 57, 90, 50, -31, -87, -73, },
  { 64, 46, -43, -90, -50, 38, 90, 54, -36, -90, -57, 31, 89, 61, -25, -88, -64, 22, 87, 67, -18, -85, -70, 13, 83, 73, -9, -82, -75, 4, 80, 78, },
  { 64, 38, -57, -88, -18, 73, 80, -4, -83, -67, 25, 90, 50, -46, -90, -31, 64, 85, 9, -78, -75, 13, 87, 61, -36, -90, -43, 54, 89, 22, -70, -82, },
  { 64, 31, -70, -78, 18, 90, 43, -61, -83, 4, 87, 54, -50, -88, -9, 82, 64, -38, -90, -22, 75, 73, -25, -90, -36, 67, 80, -13, -89, -46, 57, 85, },
  { 64, 22, -80, -61, 50, 85, -9, -90, -36, 73, 70, -38, -89, -4, 87, 46, -64, -78, 25, 90, 18, -82, -57, 54, 83, -13, -90, -31, 75, 67, -43, -88, },
  { 64, 13, -87, -38, 75, 61, -57, -78, 36, 88, -9, -90, -18, 85, 43, -73, -64, 54, 80, -31, -89, 4, 90, 22, -83, -46, 70, 67, -50, -82, 25, 90, },
  { 64, 4, -90, -13, 89, 22, -87, -31, 83, 38, -80, -46, 75, 54, -70, -61, 64, 67, -57, -73, 50, 78, -43, -82, 36, 85, -25, -88, 18, 90, -9, -90, },
  { 64, -4, -90, 13, 89, -22, -87, 31, 83, -38, -80, 46, 75, -54, -70, 61, 64, -67, -57, 73, 50, -78, -43, 82, 36, -85, -25, 88, 18, -90, -9, 90, },
  { 64, -13, -87, 38, 75, -61, -57, 78, 36, -88, -9, 90, -18, -85, 43, 73, -64, -54, 80, 31, -89, -4, 90, -22, -83, 46, 70, -67, -50, 82, 25, -90, },
  { 64, -22, -80, 61, 50, -85, -9, 90, -36, -73, 70, 38, -89, 4, 87, -46, -64, 78, 25, -90, 18, 82, -57, -54, 83, 13, -90, 31, 75, -67, -43, 88, },
  { 64, -31, -70, 78, 18, -90, 43, 61, -83, -4, 87, -54, -50, 88, -9, -82, 64, 38, -90, 22, 75, -73, -25, 90, -36, -67, 80, 13, -89, 46, 57, -85, },
  { 64, -38, -57, 88, -18, -73, 80, 4, -83, 67, 25, -90, 50, 46, -90, 31, 64, -85, 9, 78, -75, -13, 87, -61, -36, 90, -43, -54, 89, -22, -70, 82, },
  { 64, -46, -43, 90, -50, -38, 90, -54, -36, 90, -57, -31, 89, -61, -25, 88, -64, -22, 87, -67, -18, 85, -70, -13, 83, -73, -9, 82, -75, -4, 80, -78, },
  { 64, -54, -25, 85, -75, 4, 70, -88, 36, 46, -90, 61, 18, -82, 80, -13, -64, 90, -43, -38, 89, -67, -9, 78, -83, 22, 57, -90, 50, 31, -87, 73, },
  { 64, -61, -9, 73, -89, 46, 25, -82, 83, -31, -43, 88, -75, 13, 57, -90, 64, 4, -70, 90, -50, -22, 80, -85, 36, 38, -87, 78, -18, -54, 90, -67, },
  { 64, -67, 9, 54, -89, 78, -25, -38, 83, -85, 43, 22, -75, 90, -57, -4, 64, -90, 70, -13, -50, 88, -80, 31, 36, -82, 87, -46, -18, 73, -90, 61, },
  { 64, -73, 25, 31, -75, 90, -70, 22, 36, -78, 90, -67, 18, 38, -80, 90, -64, 13, 43, -82, 89, -61, 9, 46, -83, 88, -57, 4, 50, -85, 87, -54, },
  { 64, -78, 43, 4, -50, 82, -90, 73, -36, -13, 57, -85, 89, -67, 25, 22, -64, 88, -87, 61, -18, -31, 70, -90, 83, -54, 9, 38, -75, 90, -80, 46, },
  { 64, -82, 57, -22, -18, 54, -80, 90, -83, 61, -25, -13, 50, -78, 90, -85, 64, -31, -9, 46, -75, 90, -87, 67, -36, -4, 43, -73, 89, -88, 70, -38, },
  { 64, -85, 70, -46, 18, 13, -43, 67, -83, 90, -87, 73, -50, 22, 9, -38, 64, -82, 90, -88, 75, -54, 25, 4, -36, 61, -80, 90, -89, 78, -57, 31, },
  { 64, -88, 80, -67, 50, -31, 9, 13, -36, 54, -70, 82, -89, 90, -87, 78, -64, 46, -25, 4, 18, -38, 57, -73, 83, -90, 90, -85, 75, -61, 43, -22, },
  { 64, -90, 87, -82, 75, -67, 57, -46, 36, -22, 9, 4, -18, 31, -43, 54, -64, 73, -80, 85, -89, 90, -90, 88, -83, 78, -70, 61, -50, 38, -25, 13, },
  { 64, -90, 90, -90, 89, -88, 87, -85, 83, -82, 80, -78, 75, -73, 70, -67, 64, -61, 57, -54, 50, -46, 43, -38, 36, -31, 25, -22, 18, -13, 9, -4 }
};

const int16_t kvz_g_dct_64_t[64][64] =
{
  { 64, 91, 90, 90, 90, 90, 90, 90, 89, 88, 88, 87, 87, 86, 85, 84, 83, 83, 82, 81, 80, 79, 78, 77, 75, 73, 73, 71, 70, 69, 67, 65, 64, 62, 61, 59, 57, 56, 54, 52, 50, 48, 46, 44, 43, 41, 38, 37, 36, 33, 31, 28, 25, 24, 22, 20, 18, 15, 13, 11, 9, 7, 4, 2, },
  { 64, 90, 90, 88, 87, 84, 82, 79, 75, 71, 67, 62, 57, 52, 46, 41, 36, 28, 22, 15, 9, 2, -4, -11, -18, -24, -31, -37, -43, -48, -54, -59, -64, -69, -73, -77, -80, -83, -85, -87, -89, -90, -90, -91, -90, -90, -88, -86, -83, -81, -78, -73, -70, -65, -61, -56, -50, -44, -38, -33, -25, -20, -13, -7, },
  { 64, 90, 88, 84, 80, 73, 67, 59, 50, 41, 31, 20, 9, -2, -13, -24, -36, -44, -54, -62, -70, -77, -82, -86, -89, -90, -90, -90, -87, -83, -78, -71, -64, -56, -46, -37, -25, -15, -4, 7, 18, 28, 38, 48, 57, 65, 73, 79, 83, 87, 90, 91, 90, 88, 85, 81, 75, 69, 61, 52, 43, 33, 22, 11, },
  { 64, 90, 85, 79, 70, 59, 46, 33, 18, 2, -13, -28, -43, -56, -67, -77, -83, -88, -90, -90, -87, -81, -73, -62, -50, -37, -22, -7, 9, 24, 38, 52, 64, 73, 82, 87, 90, 90, 88, 83, 75, 65, 54, 41, 25, 11, -4, -20, -36, -48, -61, -71, -80, -86, -90, -91, -89, -84, -78, -69, -57, -44, -31, -15, },
  { 64, 88, 82, 71, 57, 41, 22, 2, -18, -37, -54, -69, -80, -87, -90, -90, -83, -73, -61, -44, -25, -7, 13, 33, 50, 65, 78, 86, 90, 90, 85, 77, 64, 48, 31, 11, -9, -28, -46, -62, -75, -84, -90, -90, -87, -79, -67, -52, -36, -15, 4, 24, 43, 59, 73, 83, 89, 91, 88, 81, 70, 56, 38, 20, },
  { 64, 87, 78, 62, 43, 20, -4, -28, -50, -69, -82, -90, -90, -84, -73, -56, -36, -11, 13, 37, 57, 73, 85, 90, 89, 81, 67, 48, 25, 2, -22, -44, -64, -79, -88, -91, -87, -77, -61, -41, -18, 7, 31, 52, 70, 83, 90, 90, 83, 71, 54, 33, 9, -15, -38, -59, -75, -86, -90, -88, -80, -65, -46, -24, },
  { 64, 86, 73, 52, 25, -2, -31, -56, -75, -87, -90, -84, -70, -48, -22, 7, 36, 59, 78, 88, 90, 83, 67, 44, 18, -11, -38, -62, -80, -90, -90, -81, -64, -41, -13, 15, 43, 65, 82, 90, 89, 79, 61, 37, 9, -20, -46, -69, -83, -90, -88, -77, -57, -33, -4, 24, 50, 71, 85, 91, 87, 73, 54, 28, },
  { 64, 84, 67, 41, 9, -24, -54, -77, -89, -90, -78, -56, -25, 7, 38, 65, 83, 91, 85, 69, 43, 11, -22, -52, -75, -88, -90, -79, -57, -28, 4, 37, 64, 83, 90, 86, 70, 44, 13, -20, -50, -73, -88, -90, -80, -59, -31, 2, 36, 62, 82, 90, 87, 71, 46, 15, -18, -48, -73, -87, -90, -81, -61, -33, },
  { 64, 83, 61, 28, -9, -44, -73, -88, -89, -73, -46, -11, 25, 59, 82, 91, 83, 62, 31, -7, -43, -71, -88, -90, -75, -48, -13, 24, 57, 81, 90, 84, 64, 33, -4, -41, -70, -87, -90, -77, -50, -15, 22, 56, 80, 90, 85, 65, 36, -2, -38, -69, -87, -90, -78, -52, -18, 20, 54, 79, 90, 86, 67, 37, },
  { 64, 81, 54, 15, -25, -62, -85, -90, -75, -44, -4, 37, 70, 88, 88, 69, 36, -7, -46, -77, -90, -84, -61, -24, 18, 56, 82, 91, 80, 52, 13, -28, -64, -86, -90, -73, -43, -2, 38, 71, 89, 87, 67, 33, -9, -48, -78, -90, -83, -59, -22, 20, 57, 83, 90, 79, 50, 11, -31, -65, -87, -90, -73, -41, },
  { 64, 79, 46, 2, -43, -77, -90, -81, -50, -7, 38, 73, 90, 83, 54, 11, -36, -71, -90, -84, -57, -15, 31, 69, 89, 86, 61, 20, -25, -65, -88, -87, -64, -24, 22, 62, 87, 88, 67, 28, -18, -59, -85, -90, -70, -33, 13, 56, 83, 90, 73, 37, -9, -52, -82, -90, -75, -41, 4, 48, 80, 91, 78, 44, },
  { 64, 77, 38, -11, -57, -86, -88, -62, -18, 33, 73, 90, 80, 44, -4, -52, -83, -90, -67, -24, 25, 69, 90, 83, 50, 2, -46, -81, -90, -71, -31, 20, 64, 88, 85, 56, 9, -41, -78, -91, -75, -37, 13, 59, 87, 87, 61, 15, -36, -73, -90, -79, -43, 7, 54, 84, 89, 65, 22, -28, -70, -90, -82, -48, },
  { 64, 73, 31, -24, -70, -90, -78, -37, 18, 65, 90, 81, 43, -11, -61, -88, -83, -48, 4, 56, 87, 86, 54, 2, -50, -84, -88, -59, -9, 44, 82, 90, 64, 15, -38, -79, -90, -69, -22, 33, 75, 91, 73, 28, -25, -71, -90, -77, -36, 20, 67, 90, 80, 41, -13, -62, -89, -83, -46, 7, 57, 87, 85, 52, },
  { 64, 71, 22, -37, -80, -90, -61, -7, 50, 86, 85, 48, -9, -62, -90, -79, -36, 24, 73, 91, 70, 20, -38, -81, -89, -59, -4, 52, 87, 84, 46, -11, -64, -90, -78, -33, 25, 73, 90, 69, 18, -41, -82, -88, -57, -2, 54, 87, 83, 44, -13, -65, -90, -77, -31, 28, 75, 90, 67, 15, -43, -83, -88, -56, },
  { 64, 69, 13, -48, -87, -83, -38, 24, 75, 90, 61, 2, -57, -90, -78, -28, 36, 81, 88, 52, -9, -65, -90, -71, -18, 44, 85, 84, 43, -20, -73, -90, -64, -7, 54, 88, 80, 33, -31, -79, -89, -56, 4, 62, 90, 73, 22, -41, -83, -86, -46, 15, 70, 91, 67, 11, -50, -87, -82, -37, 25, 77, 90, 59, },
  { 64, 65, 4, -59, -90, -71, -13, 52, 89, 77, 22, -44, -87, -81, -31, 37, 83, 84, 38, -28, -80, -87, -46, 20, 75, 90, 54, -11, -70, -90, -61, 2, 64, 91, 67, 7, -57, -90, -73, -15, 50, 88, 78, 24, -43, -86, -82, -33, 36, 83, 85, 41, -25, -79, -88, -48, 18, 73, 90, 56, -9, -69, -90, -62, },
  { 64, 62, -4, -69, -90, -56, 13, 73, 89, 48, -22, -79, -87, -41, 31, 83, 83, 33, -38, -86, -80, -24, 46, 88, 75, 15, -54, -90, -70, -7, 61, 91, 64, -2, -67, -90, -57, 11, 73, 90, 50, -20, -78, -87, -43, 28, 82, 84, 36, -37, -85, -81, -25, 44, 88, 77, 18, -52, -90, -71, -9, 59, 90, 65, },
  { 64, 59, -13, -77, -87, -37, 38, 87, 75, 11, -61, -91, -57, 15, 78, 86, 36, -41, -88, -73, -9, 62, 90, 56, -18, -79, -85, -33, 43, 88, 73, 7, -64, -90, -54, 20, 80, 84, 31, -44, -89, -71, -4, 65, 90, 52, -22, -81, -83, -28, 46, 90, 70, 2, -67, -90, -50, 24, 82, 83, 25, -48, -90, -69, },
  { 64, 56, -22, -83, -80, -15, 61, 90, 50, -28, -85, -77, -9, 65, 90, 44, -36, -87, -73, -2, 70, 88, 38, -41, -89, -69, 4, 73, 87, 33, -46, -90, -64, 11, 78, 84, 25, -52, -90, -59, 18, 81, 82, 20, -57, -91, -54, 24, 83, 79, 13, -62, -90, -48, 31, 86, 75, 7, -67, -90, -43, 37, 88, 71, },
  { 64, 52, -31, -87, -70, 7, 78, 83, 18, -62, -90, -41, 43, 90, 61, -20, -83, -77, -4, 71, 87, 28, -54, -91, -50, 33, 88, 69, -9, -79, -82, -15, 64, 90, 38, -44, -90, -59, 22, 84, 75, 2, -73, -86, -25, 56, 90, 48, -36, -88, -67, 11, 80, 81, 13, -65, -89, -37, 46, 90, 57, -24, -85, -73, },
  { 64, 48, -38, -90, -57, 28, 88, 65, -18, -84, -73, 7, 80, 79, 4, -73, -83, -15, 67, 87, 25, -59, -90, -37, 50, 91, 46, -41, -90, -56, 31, 88, 64, -20, -85, -71, 9, 81, 78, 2, -75, -83, -13, 69, 87, 24, -61, -90, -36, 52, 90, 44, -43, -90, -54, 33, 89, 62, -22, -86, -70, 11, 82, 77, },
  { 64, 44, -46, -91, -43, 48, 90, 41, -50, -90, -38, 52, 90, 37, -54, -90, -36, 56, 90, 33, -57, -90, -31, 59, 89, 28, -61, -88, -25, 62, 88, 24, -64, -87, -22, 65, 87, 20, -67, -86, -18, 69, 85, 15, -70, -84, -13, 71, 83, 11, -73, -83, -9, 73, 82, 7, -75, -81, -4, 77, 80, 2, -78, -79, },
  { 64, 41, -54, -90, -25, 65, 85, 11, -75, -79, 4, 83, 70, -20, -88, -59, 36, 90, 46, -48, -90, -33, 61, 87, 18, -71, -82, -2, 80, 73, -13, -86, -64, 28, 90, 52, -43, -91, -38, 56, 89, 24, -67, -84, -9, 77, 78, -7, -83, -69, 22, 88, 57, -37, -90, -44, 50, 90, 31, -62, -87, -15, 73, 81, },
  { 64, 37, -61, -86, -9, 79, 73, -20, -89, -52, 46, 90, 25, -69, -82, 2, 83, 65, -31, -90, -43, 56, 88, 15, -75, -77, 13, 87, 57, -41, -90, -33, 64, 84, 4, -81, -70, 24, 90, 48, -50, -90, -22, 71, 80, -7, -85, -62, 36, 91, 38, -59, -87, -11, 78, 73, -18, -88, -54, 44, 90, 28, -67, -83, },
  { 64, 33, -67, -81, 9, 87, 54, -48, -89, -15, 78, 71, -25, -90, -38, 62, 83, -2, -85, -59, 43, 90, 22, -73, -75, 20, 90, 44, -57, -86, -4, 83, 64, -37, -90, -28, 70, 79, -13, -88, -50, 52, 88, 11, -80, -69, 31, 91, 36, -65, -82, 7, 87, 56, -46, -90, -18, 77, 73, -24, -90, -41, 61, 84, },
  { 64, 28, -73, -73, 25, 91, 31, -71, -75, 24, 90, 33, -70, -77, 22, 90, 36, -69, -78, 20, 90, 37, -67, -79, 18, 90, 38, -65, -80, 15, 90, 41, -64, -81, 13, 90, 43, -62, -82, 11, 89, 44, -61, -83, 9, 88, 46, -59, -83, 7, 88, 48, -57, -84, 4, 87, 50, -56, -85, 2, 87, 52, -54, -86, },
  { 64, 24, -78, -65, 43, 88, 4, -86, -50, 59, 82, -15, -90, -33, 73, 71, -36, -90, -13, 83, 57, -52, -85, 7, 89, 41, -67, -77, 25, 91, 22, -79, -64, 44, 88, 2, -87, -48, 61, 81, -18, -90, -31, 73, 70, -37, -90, -11, 83, 56, -54, -84, 9, 90, 38, -69, -75, 28, 90, 20, -80, -62, 46, 87, },
  { 64, 20, -82, -56, 57, 81, -22, -91, -18, 83, 54, -59, -80, 24, 90, 15, -83, -52, 61, 79, -25, -90, -13, 84, 50, -62, -78, 28, 90, 11, -85, -48, 64, 77, -31, -90, -9, 86, 46, -65, -75, 33, 90, 7, -87, -44, 67, 73, -36, -90, -4, 87, 43, -69, -73, 37, 89, 2, -88, -41, 70, 71, -38, -88, },
  { 64, 15, -85, -44, 70, 69, -46, -84, 18, 91, 13, -86, -43, 71, 67, -48, -83, 20, 90, 11, -87, -41, 73, 65, -50, -83, 22, 90, 9, -87, -38, 73, 64, -52, -82, 24, 90, 7, -88, -37, 75, 62, -54, -81, 25, 90, 4, -88, -36, 77, 61, -56, -80, 28, 90, 2, -89, -33, 78, 59, -57, -79, 31, 90, },
  { 64, 11, -88, -33, 80, 52, -67, -69, 50, 81, -31, -88, 9, 91, 13, -87, -36, 79, 54, -65, -70, 48, 82, -28, -89, 7, 90, 15, -87, -37, 78, 56, -64, -71, 46, 83, -25, -90, 4, 90, 18, -86, -38, 77, 57, -62, -73, 44, 83, -24, -90, 2, 90, 20, -85, -41, 75, 59, -61, -73, 43, 84, -22, -90, },
  { 64, 7, -90, -20, 87, 33, -82, -44, 75, 56, -67, -65, 57, 73, -46, -81, 36, 86, -22, -90, 9, 91, 4, -90, -18, 87, 31, -83, -43, 77, 54, -69, -64, 59, 73, -48, -80, 37, 85, -24, -89, 11, 90, 2, -90, -15, 88, 28, -83, -41, 78, 52, -70, -62, 61, 71, -50, -79, 38, 84, -25, -88, 13, 90, },
  { 64, 2, -90, -7, 90, 11, -90, -15, 89, 20, -88, -24, 87, 28, -85, -33, 83, 37, -82, -41, 80, 44, -78, -48, 75, 52, -73, -56, 70, 59, -67, -62, 64, 65, -61, -69, 57, 71, -54, -73, 50, 77, -46, -79, 43, 81, -38, -83, 36, 84, -31, -86, 25, 87, -22, -88, 18, 90, -13, -90, 9, 90, -4, -91, },
  { 64, -2, -90, 7, 90, -11, -90, 15, 89, -20, -88, 24, 87, -28, -85, 33, 83, -37, -82, 41, 80, -44, -78, 48, 75, -52, -73, 56, 70, -59, -67, 62, 64, -65, -61, 69, 57, -71, -54, 73, 50, -77, -46, 79, 43, -81, -38, 83, 36, -84, -31, 86, 25, -87, -22, 88, 18, -90, -13, 90, 9, -90, -4, 91, },
  { 64, -7, -90, 20, 87, -33, -82, 44, 75, -56, -67, 65, 57, -73, -46, 81, 36, -86, -22, 90, 9, -91, 4, 90, -18, -87, 31, 83, -43, -77, 54, 69, -64, -59, 73, 48, -80, -37, 85, 24, -89, -11, 90, -2, -90, 15, 88, -28, -83, 41, 78, -52, -70, 62, 61, -71, -50, 79, 38, -84, -25, 88, 13, -90, },
  { 64, -11, -88, 33, 80, -52, -67, 69, 50, -81, -31, 88, 9, -91, 13, 87, -36, -79, 54, 65, -70, -48, 82, 28, -89, -7, 90, -15, -87, 37, 78, -56, -64, 71, 46, -83, -25, 90, 4, -90, 18, 86, -38, -77, 57, 62, -73, -44, 83, 24, -90, -2, 90, -20, -85, 41, 75, -59, -61, 73, 43, -84, -22, 90, },
  { 64, -15, -85, 44, 70, -69, -46, 84, 18, -91, 13, 86, -43, -71, 67, 48, -83, -20, 90, -11, -87, 41, 73, -65, -50, 83, 22, -90, 9, 87, -38, -73, 64, 52, -82, -24, 90, -7, -88, 37, 75, -62, -54, 81, 25, -90, 4, 88, -36, -77, 61, 56, -80, -28, 90, -2, -89, 33, 78, -59, -57, 79, 31, -90, },
  { 64, -20, -82, 56, 57, -81, -22, 91, -18, -83, 54, 59, -80, -24, 90, -15, -83, 52, 61, -79, -25, 90, -13, -84, 50, 62, -78, -28, 90, -11, -85, 48, 64, -77, -31, 90, -9, -86, 46, 65, -75, -33, 90, -7, -87, 44, 67, -73, -36, 90, -4, -87, 43, 69, -73, -37, 89, -2, -88, 41, 70, -71, -38, 88, },
  { 64, -24, -78, 65, 43, -88, 4, 86, -50, -59, 82, 15, -90, 33, 73, -71, -36, 90, -13, -83, 57, 52, -85, -7, 89, -41, -67, 77, 25, -91, 22, 79, -64, -44, 88, -2, -87, 48, 61, -81, -18, 90, -31, -73, 70, 37, -90, 11, 83, -56, -54, 84, 9, -90, 38, 69, -75, -28, 90, -20, -80, 62, 46, -87, },
  { 64, -28, -73, 73, 25, -91, 31, 71, -75, -24, 90, -33, -70, 77, 22, -90, 36, 69, -78, -20, 90, -37, -67, 79, 18, -90, 38, 65, -80, -15, 90, -41, -64, 81, 13, -90, 43, 62, -82, -11, 89, -44, -61, 83, 9, -88, 46, 59, -83, -7, 88, -48, -57, 84, 4, -87, 50, 56, -85, -2, 87, -52, -54, 86, },
  { 64, -33, -67, 81, 9, -87, 54, 48, -89, 15, 78, -71, -25, 90, -38, -62, 83, 2, -85, 59, 43, -90, 22, 73, -75, -20, 90, -44, -57, 86, -4, -83, 64, 37, -90, 28, 70, -79, -13, 88, -50, -52, 88, -11, -80, 69, 31, -91, 36, 65, -82, -7, 87, -56, -46, 90, -18, -77, 73, 24, -90, 41, 61, -84, },
  { 64, -37, -61, 86, -9, -79, 73, 20, -89, 52, 46, -90, 25, 69, -82, -2, 83, -65, -31, 90, -43, -56, 88, -15, -75, 77, 13, -87, 57, 41, -90, 33, 64, -84, 4, 81, -70, -24, 90, -48, -50, 90, -22, -71, 80, 7, -85, 62, 36, -91, 38, 59, -87, 11, 78, -73, -18, 88, -54, -44, 90, -28, -67, 83, },
  { 64, -41, -54, 90, -25, -65, 85, -11, -75, 79, 4, -83, 70, 20, -88, 59, 36, -90, 46, 48, -90, 33, 61, -87, 18, 71, -82, 2, 80, -73, -13, 86, -64, -28, 90, -52, -43, 91, -38, -56, 89, -24, -67, 84, -9, -77, 78, 7, -83, 69, 22, -88, 57, 37, -90, 44, 50, -90, 31, 62, -87, 15, 73, -81, },
  { 64, -44, -46, 91, -43, -48, 90, -41, -50, 90, -38, -52, 90, -37, -54, 90, -36, -56, 90, -33, -57, 90, -31, -59, 89, -28, -61, 88, -25, -62, 88, -24, -64, 87, -22, -65, 87, -20, -67, 86, -18, -69, 85, -15, -70, 84, -13, -71, 83, -11, -73, 83, -9, -73, 82, -7, -75, 81, -4, -77, 80, -2, -78, 79, },
  { 64, -48, -38, 90, -57, -28, 88, -65, -18, 84, -73, -7, 80, -79, 4, 73, -83, 15, 67, -87, 25, 59, -90, 37, 50, -91, 46, 41, -90, 56, 31, -88, 64, 20, -85, 71, 9, -81, 78, -2, -75, 83, -13, -69, 87, -24, -61, 90, -36, -52, 90, -44, -43, 90, -54, -33, 89, -62, -22, 86, -70, -11, 82, -77, },
  { 64, -52, -31, 87, -70, -7, 78, -83, 18, 62, -90, 41, 43, -90, 61, 20, -83, 77, -4, -71, 87, -28, -54, 91, -50, -33, 88, -69, -9, 79, -82, 15, 64, -90, 38, 44, -90, 59, 22, -84, 75, -2, -73, 86, -25, -56, 90, -48, -36, 88, -67, -11, 80, -81, 13, 65, -89, 37, 46, -90, 57, 24, -85, 73, },
  { 64, -56, -22, 83, -80, 15, 61, -90, 50, 28, -85, 77, -9, -65, 90, -44, -36, 87, -73, 2, 70, -88, 38, 41, -89, 69, 4, -73, 87, -33, -46, 90, -64, -11, 78, -84, 25, 52, -90, 59, 18, -81, 82, -20, -57, 91, -54, -24, 83, -79, 13, 62, -90, 48, 31, -86, 75, -7, -67, 90, -43, -37, 88, -71, },
  { 64, -59, -13, 77, -87, 37, 38, -87, 75, -11, -61, 91, -57, -15, 78, -86, 36, 41, -88, 73, -9, -62, 90, -56, -18, 79, -85, 33, 43, -88, 73, -7, -64, 90, -54, -20, 80, -84, 31, 44, -89, 71, -4, -65, 90, -52, -22, 81, -83, 28, 46, -90, 70, -2, -67, 90, -50, -24, 82, -83, 25, 48, -90, 69, },
  { 64, -62, -4, 69, -90, 56, 13, -73, 89, -48, -22, 79, -87, 41, 31, -83, 83, -33, -38, 86, -80, 24, 46, -88, 75, -15, -54, 90, -70, 7, 61, -91, 64, 2, -67, 90, -57, -11, 73, -90, 50, 20, -78, 87, -43, -28, 82, -84, 36, 37, -85, 81, -25, -44, 88, -77, 18, 52, -90, 71, -9, -59, 90, -65, },
  { 64, -65, 4, 59, -90, 71, -13, -52, 89, -77, 22, 44, -87, 81, -31, -37, 83, -84, 38, 28, -80, 87, -46, -20, 75, -90, 54, 11, -70, 90, -61, -2, 64, -91, 67, -7, -57, 90, -73, 15, 50, -88, 78, -24, -43, 86, -82, 33, 36, -83, 85, -41, -25, 79, -88, 48, 18, -73, 90, -56, -9, 69, -90, 62, },
  { 64, -69, 13, 48, -87, 83, -38, -24, 75, -90, 61, -2, -57, 90, -78, 28, 36, -81, 88, -52, -9, 65, -90, 71, -18, -44, 85, -84, 43, 20, -73, 90, -64, 7, 54, -88, 80, -33, -31, 79, -89, 56, 4, -62, 90, -73, 22, 41, -83, 86, -46, -15, 70, -91, 67, -11, -50, 87, -82, 37, 25, -77, 90, -59, },
  { 64, -71, 22, 37, -80, 90, -61, 7, 50, -86, 85, -48, -9, 62, -90, 79, -36, -24, 73, -91, 70, -20, -38, 81, -89, 59, -4, -52, 87, -84, 46, 11, -64, 90, -78, 33, 25, -73, 90, -69, 18, 41, -82, 88, -57, 2, 54, -87, 83, -44, -13, 65, -90, 77, -31, -28, 75, -90, 67, -15, -43, 83, -88, 56, },
  { 64, -73, 31, 24, -70, 90, -78, 37, 18, -65, 90, -81, 43, 11, -61, 88, -83, 48, 4, -56, 87, -86, 54, -2, -50, 84, -88, 59, -9, -44, 82, -90, 64, -15, -38, 79, -90, 69, -22, -33, 75, -91, 73, -28, -25, 71, -90, 77, -36, -20, 67, -90, 80, -41, -13, 62, -89, 83, -46, -7, 57, -87, 85, -52, },
  { 64, -77, 38, 11, -57, 86, -88, 62, -18, -33, 73, -90, 80, -44, -4, 52, -83, 90, -67, 24, 25, -69, 90, -83, 50, -2, -46, 81, -90, 71, -31, -20, 64, -88, 85, -56, 9, 41, -78, 91, -75, 37, 13, -59, 87, -87, 61, -15, -36, 73, -90, 79, -43, -7, 54, -84, 89, -65, 22, 28, -70, 90, -82, 48, },
  { 64, -79, 46, -2, -43, 77, -90, 81, -50, 7, 38, -73, 90, -83, 54, -11, -36, 71, -90, 84, -57, 15, 31, -69, 89, -86, 61, -20, -25, 65, -88, 87, -64, 24, 22, -62, 87, -88, 67, -28, -18, 59, -85, 90, -70, 33, 13, -56, 83, -90, 73, -37, -9, 52, -82, 90, -75, 41, 4, -48, 80, -91, 78, -44, },
  { 64, -81, 54, -15, -25, 62, -85, 90, -75, 44, -4, -37, 70, -88, 88, -69, 36, 7, -46, 77, -90, 84, -61, 24, 18, -56, 82, -91, 80, -52, 13, 28, -64, 86, -90, 73, -43, 2, 38, -71, 89, -87, 67, -33, -9, 48, -78, 90, -83, 59, -22, -20, 57, -83, 90, -79, 50, -11, -31, 65, -87, 90, -73, 41, },
  { 64, -83, 61, -28, -9, 44, -73, 88, -89, 73, -46, 11, 25, -59, 82, -91, 83, -62, 31, 7, -43, 71, -88, 90, -75, 48, -13, -24, 57, -81, 90, -84, 64, -33, -4, 41, -70, 87, -90, 77, -50, 15, 22, -56, 80, -90, 85, -65, 36, 2, -38, 69, -87, 90, -78, 52, -18, -20, 54, -79, 90, -86, 67, -37, },
  { 64, -84, 67, -41, 9, 24, -54, 77, -89, 90, -78, 56, -25, -7, 38, -65, 83, -91, 85, -69, 43, -11, -22, 52, -75, 88, -90, 79, -57, 28, 4, -37, 64, -83, 90, -86, 70, -44, 13, 20, -50, 73, -88, 90, -80, 59, -31, -2, 36, -62, 82, -90, 87, -71, 46, -15, -18, 48, -73, 87, -90, 81, -61, 33, },
  { 64, -86, 73, -52, 25, 2, -31, 56, -75, 87, -90, 84, -70, 48, -22, -7, 36, -59, 78, -88, 90, -83, 67, -44, 18, 11, -38, 62, -80, 90, -90, 81, -64, 41, -13, -15, 43, -65, 82, -90, 89, -79, 61, -37, 9, 20, -46, 69, -83, 90, -88, 77, -57, 33, -4, -24, 50, -71, 85, -91, 87, -73, 54, -28, },
  { 64, -87, 78, -62, 43, -20, -4, 28, -50, 69, -82, 90, -90, 84, -73, 56, -36, 11, 13, -37, 57, -73, 85, -90, 89, -81, 67, -48, 25, -2, -22, 44, -64, 79, -88, 91, -87, 77, -61, 41, -18, -7, 31, -52, 70, -83, 90, -90, 83, -71, 54, -33, 9, 15, -38, 59, -75, 86, -90, 88, -80, 65, -46, 24, },
  { 64, -88, 82, -71, 57, -41, 22, -2, -18, 37, -54, 69, -80, 87, -90, 90, -83, 73, -61, 44, -25, 7, 13, -33, 50, -65, 78, -86, 90, -90, 85, -77, 64, -48, 31, -11, -9, 28, -46, 62, -75, 84, -90, 90, -87, 79, -67, 52, -36, 15, 4, -24, 43, -59, 73, -83, 89, -91, 88, -81, 70, -56, 38, -20, },
  { 64, -90, 85, -79, 70, -59, 46, -33, 18, -2, -13, 28, -43, 56, -67, 77, -83, 88, -90, 90, -87, 81, -73, 62, -50, 37, -22, 7, 9, -24, 38, -52, 64, -73, 82, -87, 90, -90, 88, -83, 75, -65, 54, -41, 25, -11, -4, 20, -36, 48, -61, 71, -80, 86, -90, 91, -89, 84, -78, 69, -57, 44, -31, 15, },
  { 64, -90, 88, -84, 80, -73, 67, -59, 50, -41, 31, -20, 9, 2, -13, 24, -36, 44, -54, 62, -70, 77, -82, 86, -89, 90, -90, 90, -87, 83, -78, 71, -64, 56, -46, 37, -25, 15, -4, -7, 18, -28, 38, -48, 57, -65, 73, -79, 83, -87, 90, -91, 90, -88, 85, -81, 75, -69, 61, -52, 43, -33, 22, -11, },
  { 64, -90, 90, -88, 87, -84, 82, -79, 75, -71, 67, -62, 57, -52, 46, -41, 36, -28, 22, -15, 9, -2, -4, 11, -18, 24, -31, 37, -43, 48, -54, 59, -64, 69, -73, 77, -80, 83, -85, 87, -89, 90, -90, 91, -90, 90, -88, 86, -83, 81, -78, 73, -70, 65, -61, 56, -50, 44, -38, 33, -25, 20, -13, 7, },
  { 64, -91, 90, -90, 90, -90, 90, -90, 89, -88, 88, -87, 87, -86, 85, -84, 83, -83, 82, -81, 80, -79, 78, -77, 75, -73, 73, -71, 70, -69, 67, -65, 64, -62, 61, -59, 57, -56, 54, -52, 50, -48, 46, -44, 43, -41, 38, -37, 36, -33, 31, -28, 25, -24, 22, -20, 18, -15, 13, -11, 9, -7, 4, -2, }
};
/**
 * \brief Generic partial butterfly functions
 *
 * TODO: description
 *
 * \param TODO
 *
 * \returns TODO
 */

 // Fast DST Algorithm. Full matrix multiplication for DST and Fast DST algorithm
 // gives identical results
static void fast_forward_dst_4_generic(const short* block, short* coeff, int32_t shift)  // input block, output coeff
{
  int32_t i, c[4];
  int32_t rnd_factor = 1 << (shift - 1);
  for (i = 0; i < 4; i++) {
    // int32_termediate Variables
    c[0] = block[4 * i + 0] + block[4 * i + 3];
    c[1] = block[4 * i + 1] + block[4 * i + 3];
    c[2] = block[4 * i + 0] - block[4 * i + 1];
    c[3] = 74 * block[4 * i + 2];

    coeff[i] = (short)((29 * c[0] + 55 * c[1] + c[3] + rnd_factor) >> shift);
    coeff[4 + i] = (short)((74 * (block[4 * i + 0] + block[4 * i + 1] - block[4 * i + 3]) + rnd_factor) >> shift);
    coeff[8 + i] = (short)((29 * c[2] + 55 * c[0] - c[3] + rnd_factor) >> shift);
    coeff[12 + i] = (short)((55 * c[2] - 29 * c[1] + c[3] + rnd_factor) >> shift);
  }
}

static void fast_inverse_dst_4_generic(const short* tmp, short* block, int shift)  // input tmp, output block
{
  int i, c[4];
  int rnd_factor = 1 << (shift - 1);
  for (i = 0; i < 4; i++) {
    // Intermediate Variables
    c[0] = tmp[i] + tmp[8 + i];
    c[1] = tmp[8 + i] + tmp[12 + i];
    c[2] = tmp[i] - tmp[12 + i];
    c[3] = 74 * tmp[4 + i];

    block[4 * i + 0] = (short)CLIP(-32768, 32767, (29 * c[0] + 55 * c[1] + c[3] + rnd_factor) >> shift);
    block[4 * i + 1] = (short)CLIP(-32768, 32767, (55 * c[2] - 29 * c[1] + c[3] + rnd_factor) >> shift);
    block[4 * i + 2] = (short)CLIP(-32768, 32767, (74 * (tmp[i] - tmp[8 + i] + tmp[12 + i]) + rnd_factor) >> shift);
    block[4 * i + 3] = (short)CLIP(-32768, 32767, (55 * c[0] + 29 * c[2] - c[3] + rnd_factor) >> shift);
  }
}


static void partial_butterfly_4_generic(const short* src, short* dst,
  int32_t shift)
{
  int32_t j;
  int32_t e[2], o[2];
  int32_t add = 1 << (shift - 1);
  const int32_t line = 4;

  for (j = 0; j < line; j++) {
    // E and O
    e[0] = src[0] + src[3];
    o[0] = src[0] - src[3];
    e[1] = src[1] + src[2];
    o[1] = src[1] - src[2];

    dst[0] = (short)((kvz_g_dct_4[0][0] * e[0] + kvz_g_dct_4[0][1] * e[1] + add) >> shift);
    dst[2 * line] = (short)((kvz_g_dct_4[2][0] * e[0] + kvz_g_dct_4[2][1] * e[1] + add) >> shift);
    dst[line] = (short)((kvz_g_dct_4[1][0] * o[0] + kvz_g_dct_4[1][1] * o[1] + add) >> shift);
    dst[3 * line] = (short)((kvz_g_dct_4[3][0] * o[0] + kvz_g_dct_4[3][1] * o[1] + add) >> shift);

    src += 4;
    dst++;
  }
}


static void partial_butterfly_inverse_4_generic(const short* src, short* dst,
  int shift)
{
  int j;
  int e[2], o[2];
  int add = 1 << (shift - 1);
  const int32_t line = 4;

  for (j = 0; j < line; j++) {
    // Utilizing symmetry properties to the maximum to minimize the number of multiplications
    o[0] = kvz_g_dct_4[1][0] * src[line] + kvz_g_dct_4[3][0] * src[3 * line];
    o[1] = kvz_g_dct_4[1][1] * src[line] + kvz_g_dct_4[3][1] * src[3 * line];
    e[0] = kvz_g_dct_4[0][0] * src[0] + kvz_g_dct_4[2][0] * src[2 * line];
    e[1] = kvz_g_dct_4[0][1] * src[0] + kvz_g_dct_4[2][1] * src[2 * line];

    // Combining even and odd terms at each hierarchy levels to calculate the final spatial domain vector
    dst[0] = (short)CLIP(-32768, 32767, (e[0] + o[0] + add) >> shift);
    dst[1] = (short)CLIP(-32768, 32767, (e[1] + o[1] + add) >> shift);
    dst[2] = (short)CLIP(-32768, 32767, (e[1] - o[1] + add) >> shift);
    dst[3] = (short)CLIP(-32768, 32767, (e[0] - o[0] + add) >> shift);

    src++;
    dst += 4;
  }
}


static void partial_butterfly_8_generic(const short* src, short* dst,
  int32_t shift)
{
  int32_t j, k;
  int32_t e[4], o[4];
  int32_t ee[2], eo[2];
  int32_t add = 1 << (shift - 1);
  const int32_t line = 8;

  for (j = 0; j < line; j++) {
    // E and O
    for (k = 0; k < 4; k++) {
      e[k] = src[k] + src[7 - k];
      o[k] = src[k] - src[7 - k];
    }
    // EE and EO
    ee[0] = e[0] + e[3];
    eo[0] = e[0] - e[3];
    ee[1] = e[1] + e[2];
    eo[1] = e[1] - e[2];

    dst[0] = (short)((kvz_g_dct_8[0][0] * ee[0] + kvz_g_dct_8[0][1] * ee[1] + add) >> shift);
    dst[4 * line] = (short)((kvz_g_dct_8[4][0] * ee[0] + kvz_g_dct_8[4][1] * ee[1] + add) >> shift);
    dst[2 * line] = (short)((kvz_g_dct_8[2][0] * eo[0] + kvz_g_dct_8[2][1] * eo[1] + add) >> shift);
    dst[6 * line] = (short)((kvz_g_dct_8[6][0] * eo[0] + kvz_g_dct_8[6][1] * eo[1] + add) >> shift);

    dst[line] = (short)((kvz_g_dct_8[1][0] * o[0] + kvz_g_dct_8[1][1] * o[1] + kvz_g_dct_8[1][2] * o[2] + kvz_g_dct_8[1][3] * o[3] + add) >> shift);
    dst[3 * line] = (short)((kvz_g_dct_8[3][0] * o[0] + kvz_g_dct_8[3][1] * o[1] + kvz_g_dct_8[3][2] * o[2] + kvz_g_dct_8[3][3] * o[3] + add) >> shift);
    dst[5 * line] = (short)((kvz_g_dct_8[5][0] * o[0] + kvz_g_dct_8[5][1] * o[1] + kvz_g_dct_8[5][2] * o[2] + kvz_g_dct_8[5][3] * o[3] + add) >> shift);
    dst[7 * line] = (short)((kvz_g_dct_8[7][0] * o[0] + kvz_g_dct_8[7][1] * o[1] + kvz_g_dct_8[7][2] * o[2] + kvz_g_dct_8[7][3] * o[3] + add) >> shift);

    src += 8;
    dst++;
  }
}


static void partial_butterfly_inverse_8_generic(const int16_t* src, int16_t* dst,
  int32_t shift)
{
  int32_t j, k;
  int32_t e[4], o[4];
  int32_t ee[2], eo[2];
  int32_t add = 1 << (shift - 1);
  const int32_t line = 8;

  for (j = 0; j < line; j++) {
    // Utilizing symmetry properties to the maximum to minimize the number of multiplications
    for (k = 0; k < 4; k++) {
      o[k] = kvz_g_dct_8[1][k] * src[line] + kvz_g_dct_8[3][k] * src[3 * line] + kvz_g_dct_8[5][k] * src[5 * line] + kvz_g_dct_8[7][k] * src[7 * line];
    }

    eo[0] = kvz_g_dct_8[2][0] * src[2 * line] + kvz_g_dct_8[6][0] * src[6 * line];
    eo[1] = kvz_g_dct_8[2][1] * src[2 * line] + kvz_g_dct_8[6][1] * src[6 * line];
    ee[0] = kvz_g_dct_8[0][0] * src[0] + kvz_g_dct_8[4][0] * src[4 * line];
    ee[1] = kvz_g_dct_8[0][1] * src[0] + kvz_g_dct_8[4][1] * src[4 * line];

    // Combining even and odd terms at each hierarchy levels to calculate the final spatial domain vector
    e[0] = ee[0] + eo[0];
    e[3] = ee[0] - eo[0];
    e[1] = ee[1] + eo[1];
    e[2] = ee[1] - eo[1];
    for (k = 0; k < 4; k++) {
      dst[k] = (int16_t)MAX(-32768, MIN(32767, (e[k] + o[k] + add) >> shift));
      dst[k + 4] = (int16_t)MAX(-32768, MIN(32767, (e[3 - k] - o[3 - k] + add) >> shift));
    }
    src++;
    dst += 8;
  }
}


static void partial_butterfly_16_generic(const short* src, short* dst,
  int32_t shift)
{
  int32_t j, k;
  int32_t e[8], o[8];
  int32_t ee[4], eo[4];
  int32_t eee[2], eeo[2];
  int32_t add = 1 << (shift - 1);
  const int32_t line = 16;

  for (j = 0; j < line; j++) {
    // E and O
    for (k = 0; k < 8; k++) {
      e[k] = src[k] + src[15 - k];
      o[k] = src[k] - src[15 - k];
    }
    // EE and EO
    for (k = 0; k < 4; k++) {
      ee[k] = e[k] + e[7 - k];
      eo[k] = e[k] - e[7 - k];
    }
    // EEE and EEO
    eee[0] = ee[0] + ee[3];
    eeo[0] = ee[0] - ee[3];
    eee[1] = ee[1] + ee[2];
    eeo[1] = ee[1] - ee[2];

    dst[0] = (short)((kvz_g_dct_16[0][0] * eee[0] + kvz_g_dct_16[0][1] * eee[1] + add) >> shift);
    dst[8 * line] = (short)((kvz_g_dct_16[8][0] * eee[0] + kvz_g_dct_16[8][1] * eee[1] + add) >> shift);
    dst[4 * line] = (short)((kvz_g_dct_16[4][0] * eeo[0] + kvz_g_dct_16[4][1] * eeo[1] + add) >> shift);
    dst[12 * line] = (short)((kvz_g_dct_16[12][0] * eeo[0] + kvz_g_dct_16[12][1] * eeo[1] + add) >> shift);

    for (k = 2; k < 16; k += 4) {
      dst[k * line] = (short)((kvz_g_dct_16[k][0] * eo[0] + kvz_g_dct_16[k][1] * eo[1] + kvz_g_dct_16[k][2] * eo[2] + kvz_g_dct_16[k][3] * eo[3] + add) >> shift);
    }

    for (k = 1; k < 16; k += 2) {
      dst[k * line] = (short)((kvz_g_dct_16[k][0] * o[0] + kvz_g_dct_16[k][1] * o[1] + kvz_g_dct_16[k][2] * o[2] + kvz_g_dct_16[k][3] * o[3] +
        kvz_g_dct_16[k][4] * o[4] + kvz_g_dct_16[k][5] * o[5] + kvz_g_dct_16[k][6] * o[6] + kvz_g_dct_16[k][7] * o[7] + add) >> shift);
    }

    src += 16;
    dst++;
  }
}


static void partial_butterfly_inverse_16_generic(const int16_t* src, int16_t* dst,
  int32_t shift)
{
  int32_t j, k;
  int32_t e[8], o[8];
  int32_t ee[4], eo[4];
  int32_t eee[2], eeo[2];
  int32_t add = 1 << (shift - 1);
  const int32_t line = 16;

  for (j = 0; j < line; j++) {
    // Utilizing symmetry properties to the maximum to minimize the number of multiplications
    for (k = 0; k < 8; k++) {
      o[k] = kvz_g_dct_16[1][k] * src[line] + kvz_g_dct_16[3][k] * src[3 * line] + kvz_g_dct_16[5][k] * src[5 * line] + kvz_g_dct_16[7][k] * src[7 * line] +
        kvz_g_dct_16[9][k] * src[9 * line] + kvz_g_dct_16[11][k] * src[11 * line] + kvz_g_dct_16[13][k] * src[13 * line] + kvz_g_dct_16[15][k] * src[15 * line];
    }
    for (k = 0; k < 4; k++) {
      eo[k] = kvz_g_dct_16[2][k] * src[2 * line] + kvz_g_dct_16[6][k] * src[6 * line] + kvz_g_dct_16[10][k] * src[10 * line] + kvz_g_dct_16[14][k] * src[14 * line];
    }
    eeo[0] = kvz_g_dct_16[4][0] * src[4 * line] + kvz_g_dct_16[12][0] * src[12 * line];
    eee[0] = kvz_g_dct_16[0][0] * src[0] + kvz_g_dct_16[8][0] * src[8 * line];
    eeo[1] = kvz_g_dct_16[4][1] * src[4 * line] + kvz_g_dct_16[12][1] * src[12 * line];
    eee[1] = kvz_g_dct_16[0][1] * src[0] + kvz_g_dct_16[8][1] * src[8 * line];

    // Combining even and odd terms at each hierarchy levels to calculate the final spatial domain vector
    for (k = 0; k < 2; k++) {
      ee[k] = eee[k] + eeo[k];
      ee[k + 2] = eee[1 - k] - eeo[1 - k];
    }
    for (k = 0; k < 4; k++) {
      e[k] = ee[k] + eo[k];
      e[k + 4] = ee[3 - k] - eo[3 - k];
    }
    for (k = 0; k < 8; k++) {
      dst[k] = (short)MAX(-32768, MIN(32767, (e[k] + o[k] + add) >> shift));
      dst[k + 8] = (short)MAX(-32768, MIN(32767, (e[7 - k] - o[7 - k] + add) >> shift));
    }
    src++;
    dst += 16;
  }
}


static void partial_butterfly_32_generic(const short* src, short* dst,
  int32_t shift)
{
  int32_t j, k;
  int32_t e[16], o[16];
  int32_t ee[8], eo[8];
  int32_t eee[4], eeo[4];
  int32_t eeee[2], eeeo[2];
  int32_t add = 1 << (shift - 1);
  const int32_t line = 32;

  for (j = 0; j < line; j++) {
    // E and O
    for (k = 0; k < 16; k++) {
      e[k] = src[k] + src[31 - k];
      o[k] = src[k] - src[31 - k];
    }
    // EE and EO
    for (k = 0; k < 8; k++) {
      ee[k] = e[k] + e[15 - k];
      eo[k] = e[k] - e[15 - k];
    }
    // EEE and EEO
    for (k = 0; k < 4; k++) {
      eee[k] = ee[k] + ee[7 - k];
      eeo[k] = ee[k] - ee[7 - k];
    }
    // EEEE and EEEO
    eeee[0] = eee[0] + eee[3];
    eeeo[0] = eee[0] - eee[3];
    eeee[1] = eee[1] + eee[2];
    eeeo[1] = eee[1] - eee[2];

    dst[0] = (short)((kvz_g_dct_32[0][0] * eeee[0] + kvz_g_dct_32[0][1] * eeee[1] + add) >> shift);
    dst[16 * line] = (short)((kvz_g_dct_32[16][0] * eeee[0] + kvz_g_dct_32[16][1] * eeee[1] + add) >> shift);
    dst[8 * line] = (short)((kvz_g_dct_32[8][0] * eeeo[0] + kvz_g_dct_32[8][1] * eeeo[1] + add) >> shift);
    dst[24 * line] = (short)((kvz_g_dct_32[24][0] * eeeo[0] + kvz_g_dct_32[24][1] * eeeo[1] + add) >> shift);
    for (k = 4; k < 32; k += 8) {
      dst[k * line] = (short)((kvz_g_dct_32[k][0] * eeo[0] + kvz_g_dct_32[k][1] * eeo[1] + kvz_g_dct_32[k][2] * eeo[2] + kvz_g_dct_32[k][3] * eeo[3] + add) >> shift);
    }
    for (k = 2; k < 32; k += 4) {
      dst[k * line] = (short)((kvz_g_dct_32[k][0] * eo[0] + kvz_g_dct_32[k][1] * eo[1] + kvz_g_dct_32[k][2] * eo[2] + kvz_g_dct_32[k][3] * eo[3] +
        kvz_g_dct_32[k][4] * eo[4] + kvz_g_dct_32[k][5] * eo[5] + kvz_g_dct_32[k][6] * eo[6] + kvz_g_dct_32[k][7] * eo[7] + add) >> shift);
    }
    for (k = 1; k < 32; k += 2) {
      dst[k * line] = (short)((kvz_g_dct_32[k][0] * o[0] + kvz_g_dct_32[k][1] * o[1] + kvz_g_dct_32[k][2] * o[2] + kvz_g_dct_32[k][3] * o[3] +
        kvz_g_dct_32[k][4] * o[4] + kvz_g_dct_32[k][5] * o[5] + kvz_g_dct_32[k][6] * o[6] + kvz_g_dct_32[k][7] * o[7] +
        kvz_g_dct_32[k][8] * o[8] + kvz_g_dct_32[k][9] * o[9] + kvz_g_dct_32[k][10] * o[10] + kvz_g_dct_32[k][11] * o[11] +
        kvz_g_dct_32[k][12] * o[12] + kvz_g_dct_32[k][13] * o[13] + kvz_g_dct_32[k][14] * o[14] + kvz_g_dct_32[k][15] * o[15] + add) >> shift);
    }
    src += 32;
    dst++;
  }
}


static void partial_butterfly_inverse_32_generic(const int16_t* src, int16_t* dst,
  int32_t shift)
{
  int32_t j, k;
  int32_t e[16], o[16];
  int32_t ee[8], eo[8];
  int32_t eee[4], eeo[4];
  int32_t eeee[2], eeeo[2];
  int32_t add = 1 << (shift - 1);
  const int32_t line = 32;

  for (j = 0; j < line; j++) {
    // Utilizing symmetry properties to the maximum to minimize the number of multiplications
    for (k = 0; k < 16; k++) {
      o[k] = kvz_g_dct_32[1][k] * src[line] + kvz_g_dct_32[3][k] * src[3 * line] + kvz_g_dct_32[5][k] * src[5 * line] + kvz_g_dct_32[7][k] * src[7 * line] +
        kvz_g_dct_32[9][k] * src[9 * line] + kvz_g_dct_32[11][k] * src[11 * line] + kvz_g_dct_32[13][k] * src[13 * line] + kvz_g_dct_32[15][k] * src[15 * line] +
        kvz_g_dct_32[17][k] * src[17 * line] + kvz_g_dct_32[19][k] * src[19 * line] + kvz_g_dct_32[21][k] * src[21 * line] + kvz_g_dct_32[23][k] * src[23 * line] +
        kvz_g_dct_32[25][k] * src[25 * line] + kvz_g_dct_32[27][k] * src[27 * line] + kvz_g_dct_32[29][k] * src[29 * line] + kvz_g_dct_32[31][k] * src[31 * line];
    }
    for (k = 0; k < 8; k++) {
      eo[k] = kvz_g_dct_32[2][k] * src[2 * line] + kvz_g_dct_32[6][k] * src[6 * line] + kvz_g_dct_32[10][k] * src[10 * line] + kvz_g_dct_32[14][k] * src[14 * line] +
        kvz_g_dct_32[18][k] * src[18 * line] + kvz_g_dct_32[22][k] * src[22 * line] + kvz_g_dct_32[26][k] * src[26 * line] + kvz_g_dct_32[30][k] * src[30 * line];
    }
    for (k = 0; k < 4; k++) {
      eeo[k] = kvz_g_dct_32[4][k] * src[4 * line] + kvz_g_dct_32[12][k] * src[12 * line] + kvz_g_dct_32[20][k] * src[20 * line] + kvz_g_dct_32[28][k] * src[28 * line];
    }
    eeeo[0] = kvz_g_dct_32[8][0] * src[8 * line] + kvz_g_dct_32[24][0] * src[24 * line];
    eeeo[1] = kvz_g_dct_32[8][1] * src[8 * line] + kvz_g_dct_32[24][1] * src[24 * line];
    eeee[0] = kvz_g_dct_32[0][0] * src[0] + kvz_g_dct_32[16][0] * src[16 * line];
    eeee[1] = kvz_g_dct_32[0][1] * src[0] + kvz_g_dct_32[16][1] * src[16 * line];

    // Combining even and odd terms at each hierarchy levels to calculate the final spatial domain vector
    eee[0] = eeee[0] + eeeo[0];
    eee[3] = eeee[0] - eeeo[0];
    eee[1] = eeee[1] + eeeo[1];
    eee[2] = eeee[1] - eeeo[1];
    for (k = 0; k < 4; k++) {
      ee[k] = eee[k] + eeo[k];
      ee[k + 4] = eee[3 - k] - eeo[3 - k];
    }
    for (k = 0; k < 8; k++) {
      e[k] = ee[k] + eo[k];
      e[k + 8] = ee[7 - k] - eo[7 - k];
    }
    for (k = 0; k < 16; k++) {
      dst[k] = (short)MAX(-32768, MIN(32767, (e[k] + o[k] + add) >> shift));
      dst[k + 16] = (short)MAX(-32768, MIN(32767, (e[15 - k] - o[15 - k] + add) >> shift));
    }
    src++;
    dst += 32;
  }
}

#define DCT_NXN_GENERIC(n) \
static void dct_ ## n ## x ## n ## _generic(int8_t bitdepth, const int16_t *input, int16_t *output) { \
\
  int16_t tmp[ n * n ]; \
  int32_t shift_1st = kvz_g_convert_to_bit[ n ] + 1 + (bitdepth - 8); \
  int32_t shift_2nd = kvz_g_convert_to_bit[ n ] + 8; \
\
  partial_butterfly_ ## n ## _generic(input, tmp, shift_1st); \
  partial_butterfly_ ## n ## _generic(tmp, output, shift_2nd); \
}

#define IDCT_NXN_GENERIC(n) \
static void idct_ ## n ## x ## n ## _generic(int8_t bitdepth, const int16_t *input, int16_t *output) { \
\
  int16_t tmp[ n * n ]; \
  int32_t shift_1st = 7; \
  int32_t shift_2nd = 12 - (bitdepth - 8); \
\
  partial_butterfly_inverse_ ## n ## _generic(input, tmp, shift_1st); \
  partial_butterfly_inverse_ ## n ## _generic(tmp, output, shift_2nd); \
}

DCT_NXN_GENERIC(4);
DCT_NXN_GENERIC(8);
DCT_NXN_GENERIC(16);
DCT_NXN_GENERIC(32);

IDCT_NXN_GENERIC(4);
IDCT_NXN_GENERIC(8);
IDCT_NXN_GENERIC(16);
IDCT_NXN_GENERIC(32);

static void fast_forward_dst_4x4_generic(int8_t bitdepth, const int16_t* input, int16_t* output)
{
  int16_t tmp[4 * 4];
  int32_t shift_1st = kvz_g_convert_to_bit[4] + 1 + (bitdepth - 8);
  int32_t shift_2nd = kvz_g_convert_to_bit[4] + 8;

  fast_forward_dst_4_generic(input, tmp, shift_1st);
  fast_forward_dst_4_generic(tmp, output, shift_2nd);
}

static void fast_inverse_dst_4x4_generic(int8_t bitdepth, const int16_t* input, int16_t* output)
{
  int16_t tmp[4 * 4];
  int32_t shift_1st = 7;
  int32_t shift_2nd = 12 - (bitdepth - 8);

  fast_inverse_dst_4_generic(input, tmp, shift_1st);
  fast_inverse_dst_4_generic(tmp, output, shift_2nd);
}


const int16_t kvz_g_iT_DCT2_4[16] = {
256,256,256,256,
334,139,-139,-334,
256,-256,-256,256,
139,-334,334,-139 };

const int16_t kvz_g_iT_DCT2_8[64] = {
256 ,256 ,256 ,256 ,256 ,256 ,256 ,256
,355 ,301 ,201 ,71 ,-71 ,-201 ,-301 ,-355
,334 ,139 ,-139 ,-334 ,-334 ,-139 ,139 ,334
,301 ,-71 ,-355 ,-201 ,201 ,355 ,71 ,-301
,256 ,-256 ,-256 ,256 ,256 ,-256 ,-256 ,256
,201 ,-355  ,71 ,301 ,-301 ,-71 ,355 ,-201
,139 ,-334 ,334 ,-139 ,-139 ,334 ,-334 ,139
,71 ,-201 ,301 ,-355 ,355 ,-301 ,201 ,-71 };

const int16_t kvz_g_iT_DCT2_16[256] = {
256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,
360,346,319,280,230,171,105,35,-35,-105,-171,-230,-280,-319,-346,-360,
355,301,201,71,-71,-201,-301,-355,-355,-301,-201,-71,71,201,301,355,
346,230,35,-171,-319,-360,-280,-105,105,280,360,319,171,-35,-230,-346,
334,139,-139,-334,-334,-139,139,334,334,139,-139,-334,-334,-139,139,334,
319,35,-280,-346,-105,230,360,171,-171,-360,-230,105,346,280,-35,-319,
301,-71,-355,-201,201,355,71,-301,-301,71,355,201,-201,-355,-71,301,
280,-171,-346,35,360,105,-319,-230,230,319,-105,-360,-35,346,171,-280,
256,-256,-256,256,256,-256,-256,256,256,-256,-256,256,256,-256,-256,256,
230,-319,-105,360,-35,-346,171,280,-280,-171,346,35,-360,105,319,-230,
201,-355,71,301,-301,-71,355,-201,-201,355,-71,-301,301,71,-355,201,
171,-360,230,105,-346,280,35,-319,319,-35,-280,346,-105,-230,360,-171,
139,-334,334,-139,-139, 334,-334,139,139, -334, 334,-139, -139, 334, -334,139,
105,-280,360,-319,171, 35,-230,346,-346,230,-35,-171,319,-360,280,-105,
71,-201,301,-355,355,-301,201,-71,-71,201,-301,355, -355,301,-201,71,
35,-105,171,-230,280,-319,346,-360,360,-346,319, -280,230,-171,105,-35 };

const int16_t kvz_g_iT_DCT2_32[1024] = { 256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,
362,358,351,341,327,311,291,268,243,216,186,155,122,88,53,18,-18,-53,-88,-122,-155,-186,-216,-243,-268,-291,-311,-327,-341,-351,-358,-362,
360,346,319,280,230,171,105,35,-35,-105,-171,-230,-280,-319,-346,-360,-360,-346,-319,-280,-230,-171,-105,-35,35,105,171,230,280,319,346,360,
358,327,268,186,88,-18,-122,-216,-291,-341,-362,-351,-311,-243,-155,-53,53,155,243,311,351,362,341,291,216,122,18,-88,-186,-268,-327,-358,
355,301,201,71,-71,-201,-301,-355,-355,-301,-201,-71,71,201,301,355,355,301,201,71,-71,-201,-301,-355,-355,-301,-201,-71,71,201,301,355,
351,268,122,-53,-216,-327,-362,-311,-186,-18,155,291,358,341,243,88,-88,-243,-341,-358,-291,-155,18,186,311,362,327,216,53,-122,-268,-351,
346,230,35,-171,-319,-360,-280,-105,105,280,360,319,171,-35,-230,-346,-346,-230,-35,171,319,360,280,105,-105,-280,-360,-319,-171,35,230,346,
341,186,-53,-268,-362,-291,-88,155,327,351,216,-18,-243,-358,-311,-122,122,311,358,243,18,-216,-351,-327,-155,88,291,362,268,53,-186,-341,
334,139,-139,-334,-334,-139,139,334,334,139,-139,-334,-334,-139,139,334,334,139,-139,-334,-334,-139,139,334,334,139,-139,-334,-334,-139,139,334,
327,88,-216,-362,-243,53,311,341,122,-186,-358,-268,18,291,351,155,-155,-351,-291,-18,268,358,186,-122,-341,-311,-53,243,362,216,-88,-327,
319,35,-280,-346,-105,230,360,171,-171,-360,-230,105,346,280,-35,-319,-319,-35,280,346,105,-230,-360,-171,171,360,230,-105,-346,-280,35,319,
311,-18,-327,-291,53,341,268,-88,-351,-243,122,358,216,-155,-362,-186,186,362,155,-216,-358,-122,243,351,88,-268,-341,-53,291,327,18,-311,
301,-71,-355,-201,201,355,71,-301,-301,71,355,201,-201,-355,-71,301,301,-71,-355,-201,201,355,71,-301,-301,71,355,201,-201,-355,-71,301,
291,-122,-362,-88,311,268,-155,-358,-53,327,243,-186,-351,-18,341,216,-216,-341,18,351,186,-243,-327,53,358,155,-268,-311,88,362,122,-291,
280,-171,-346,35,360,105,-319,-230,230,319,-105,-360,-35,346,171,-280,-280,171,346,-35,-360,-105,319,230,-230,-319,105,360,35,-346,-171,280,
268,-216,-311,155,341,-88,-358,18,362,53,-351,-122,327,186,-291,-243,243,291,-186,-327,122,351,-53,-362,-18,358,88,-341,-155,311,216,-268,
256,-256,-256,256,256,-256,-256,256,256,-256,-256,256,256,-256,-256,256,256,-256,-256,256,256,-256,-256,256,256,-256,-256,256,256,-256,-256,256,
243,-291,-186,327,122,-351,-53,362,-18,-358,88,341,-155,-311,216,268,-268,-216,311,155,-341,-88,358,18,-362,53,351,-122,-327,186,291,-243,
230,-319,-105,360,-35,-346,171,280,-280,-171,346,35,-360,105,319,-230,-230,319,105,-360,35,346,-171,-280,280,171,-346,-35,360,-105,-319,230,
216,-341,-18,351,-186,-243,327,53,-358,155,268,-311,-88,362,-122,-291,291,122,-362,88,311,-268,-155,358,-53,-327,243,186,-351,18,341,-216,
201,-355,71,301,-301,-71,355,-201,-201,355,-71,-301,301,71,-355,201,201,-355,71,301,-301,-71,355,-201,-201,355,-71,-301,301,71,-355,201,
186,-362,155,216,-358,122,243,-351,88,268,-341,53,291,-327,18,311,-311,-18,327,-291,-53,341,-268,-88,351,-243,-122,358,-216,-155,362,-186,
171,-360,230,105,-346,280,35,-319,319,-35,-280,346,-105,-230,360,-171,-171,360,-230,-105,346,-280,-35,319,-319,35,280,-346,105,230,-360,171,
155,-351,291,-18,-268,358,-186,-122,341,-311,53,243,-362,216,88,-327,327,-88,-216,362,-243,-53,311,-341,122,186,-358,268,18,-291,351,-155,
139,-334,334,-139,-139,334,-334,139,139,-334,334,-139,-139,334,-334,139,139,-334,334,-139,-139,334,-334,139,139,-334,334,-139,-139,334,-334,139,
122,-311,358,-243,18,216,-351,327,-155,-88,291,-362,268,-53,-186,341,-341,186,53,-268,362,-291,88,155,-327,351,-216,-18,243,-358,311,-122,
105,-280,360,-319,171,35,-230,346,-346,230,-35,-171,319,-360,280,-105,-105,280,-360,319,-171,-35,230,-346,346,-230,35,171,-319,360,-280,105,
88,-243,341,-358,291,-155,-18,186,-311,362,-327,216,-53,-122,268,-351,351,-268,122,53,-216,327,-362,311,-186,18,155,-291,358,-341,243,-88,
71,-201,301,-355,355,-301,201,-71,-71,201,-301,355,-355,301,-201,71,71,-201,301,-355,355,-301,201,-71,-71,201,-301,355,-355,301,-201,71,
53,-155,243,-311,351,-362,341,-291,216,-122,18,88,-186,268,-327,358,-358,327,-268,186,-88,-18,122,-216,291,-341,362,-351,311,-243,155,-53,
35,-105,171,-230,280,-319,346,-360,360,-346,319,-280,230,-171,105,-35,-35,105,-171,230,-280,319,-346,360,-360,346,-319,280,-230,171,-105,35,
18,-53,88,-122,155,-186,216,-243,268,-291,311,-327,341,-351,358,-362,362,-358,351,-341,327,-311,291,-268,243,-216,186,-155,122,-88,53,-18 };

const int16_t kvz_g_iT_DST7_4[16] = { 117,219,296,336,
296,296,0,-296,
336,-117,-296,219,
219,-336,296,-117 };

const int16_t kvz_g_iT_DST7_8[64] = { 65,127,185,237,280,314,338,350,
185,314,350,280,127,-65,-237,-338,
280,338,127,-185,-350,-237,65,314,
338,185,-237,-314,65,350,127,-280,
350,-65,-338,127,314,-185,-280,237,
314,-280,-65,338,-237,-127,350,-185,
237,-350,280,-65,-185,338,-314,127,
127,-237,314,-350,338,-280,185,-65 };

const int16_t kvz_g_iT_DST7_16[256] = { 34,67,100,133,163,193,220,246,269,290,309,324,337,346,353,356,
100,193,269,324,353,353,324,269,193,100,0,-100,-193,-269,-324,-353,
163,290,353,337,246,100,-67,-220,-324,-356,-309,-193,-34,133,269,346,
220,346,324,163,-67,-269,-356,-290,-100,133,309,353,246,34,-193,-337,
269,353,193,-100,-324,-324,-100,193,353,269,0,-269,-353,-193,100,324,
309,309,0,-309,-309,0,309,309,0,-309,-309,0,309,309,0,-309,
337,220,-193,-346,-34,324,246,-163,-353,-67,309,269,-133,-356,-100,290,
353,100,-324,-193,269,269,-193,-324,100,353,0,-353,-100,324,193,-269,
356,-34,-353,67,346,-100,-337,133,324,-163,-309,193,290,-220,-269,246,
346,-163,-269,290,133,-353,34,337,-193,-246,309,100,-356,67,324,-220,
324,-269,-100,353,-193,-193,353,-100,-269,324,0,-324,269,100,-353,193,
290,-337,100,220,-356,193,133,-346,269,34,-309,324,-67,-246,353,-163,
246,-356,269,-34,-220,353,-290,67,193,-346,309,-100,-163,337,-324,133,
193,-324,353,-269,100,100,-269,353,-324,193,0,-193,324,-353,269,-100,
133,-246,324,-356,337,-269,163,-34,-100,220,-309,353,-346,290,-193,67,
67,-133,193,-246,290,-324,346,-356,353,-337,309,-269,220,-163,100,-34 };

const int16_t kvz_g_iT_DST7_32[1024] = { 17,35,52,69,86,103,119,135,151,167,182,197,211,225,238,251,263,275,285,296,305,314,322,329,336,342,347,351,354,357,358,359,
52,103,151,197,238,275,305,329,347,357,359,354,342,322,296,263,225,182,135,86,35,-17,-69,-119,-167,-211,-251,-285,-314,-336,-351,-358,
86,167,238,296,336,357,357,336,296,238,167,86,0,-86,-167,-238,-296,-336,-357,-357,-336,-296,-238,-167,-86,0,86,167,238,296,336,357,
119,225,305,351,357,322,251,151,35,-86,-197,-285,-342,-359,-336,-275,-182,-69,52,167,263,329,358,347,296,211,103,-17,-135,-238,-314,-354,
151,275,347,354,296,182,35,-119,-251,-336,-358,-314,-211,-69,86,225,322,359,329,238,103,-52,-197,-305,-357,-342,-263,-135,17,167,285,351,
182,314,359,305,167,-17,-197,-322,-358,-296,-151,35,211,329,357,285,135,-52,-225,-336,-354,-275,-119,69,238,342,351,263,103,-86,-251,-347,
211,342,342,211,0,-211,-342,-342,-211,0,211,342,342,211,0,-211,-342,-342,-211,0,211,342,342,211,0,-211,-342,-342,-211,0,211,342,
238,357,296,86,-167,-336,-336,-167,86,296,357,238,0,-238,-357,-296,-86,167,336,336,167,-86,-296,-357,-238,0,238,357,296,86,-167,-336,
263,358,225,-52,-296,-351,-182,103,322,336,135,-151,-342,-314,-86,197,354,285,35,-238,-359,-251,17,275,357,211,-69,-305,-347,-167,119,329,
285,347,135,-182,-357,-251,52,314,329,86,-225,-359,-211,103,336,305,35,-263,-354,-167,151,351,275,-17,-296,-342,-119,197,358,238,-69,-322,
305,322,35,-285,-336,-69,263,347,103,-238,-354,-135,211,358,167,-182,-359,-197,151,357,225,-119,-351,-251,86,342,275,-52,-329,-296,17,314,
322,285,-69,-347,-238,135,358,182,-197,-357,-119,251,342,52,-296,-314,17,329,275,-86,-351,-225,151,359,167,-211,-354,-103,263,336,35,-305,
336,238,-167,-357,-86,296,296,-86,-357,-167,238,336,0,-336,-238,167,357,86,-296,-296,86,357,167,-238,-336,0,336,238,-167,-357,-86,296,
347,182,-251,-314,86,359,103,-305,-263,167,351,17,-342,-197,238,322,-69,-358,-119,296,275,-151,-354,-35,336,211,-225,-329,52,357,135,-285,
354,119,-314,-225,238,305,-135,-351,17,357,103,-322,-211,251,296,-151,-347,35,358,86,-329,-197,263,285,-167,-342,52,359,69,-336,-182,275,
358,52,-351,-103,336,151,-314,-197,285,238,-251,-275,211,305,-167,-329,119,347,-69,-357,17,359,35,-354,-86,342,135,-322,-182,296,225,-263,
359,-17,-358,35,357,-52,-354,69,351,-86,-347,103,342,-119,-336,135,329,-151,-322,167,314,-182,-305,197,296,-211,-285,225,275,-238,-263,251,
357,-86,-336,167,296,-238,-238,296,167,-336,-86,357,0,-357,86,336,-167,-296,238,238,-296,-167,336,86,-357,0,357,-86,-336,167,296,-238,
351,-151,-285,275,167,-347,-17,354,-135,-296,263,182,-342,-35,357,-119,-305,251,197,-336,-52,358,-103,-314,238,211,-329,-69,359,-86,-322,225,
342,-211,-211,342,0,-342,211,211,-342,0,342,-211,-211,342,0,-342,211,211,-342,0,342,-211,-211,342,0,-342,211,211,-342,0,342,-211,
329,-263,-119,358,-167,-225,347,-52,-305,296,69,-351,211,182,-357,103,275,-322,-17,336,-251,-135,359,-151,-238,342,-35,-314,285,86,-354,197,
314,-305,-17,322,-296,-35,329,-285,-52,336,-275,-69,342,-263,-86,347,-251,-103,351,-238,-119,354,-225,-135,357,-211,-151,358,-197,-167,359,-182,
296,-336,86,238,-357,167,167,-357,238,86,-336,296,0,-296,336,-86,-238,357,-167,-167,357,-238,-86,336,-296,0,296,-336,86,238,-357,167,
275,-354,182,119,-336,314,-69,-225,359,-238,-52,305,-342,135,167,-351,285,-17,-263,357,-197,-103,329,-322,86,211,-358,251,35,-296,347,-151,
251,-359,263,-17,-238,358,-275,35,225,-357,285,-52,-211,354,-296,69,197,-351,305,-86,-182,347,-314,103,167,-342,322,-119,-151,336,-329,135,
225,-351,322,-151,-86,285,-359,275,-69,-167,329,-347,211,17,-238,354,-314,135,103,-296,358,-263,52,182,-336,342,-197,-35,251,-357,305,-119,
197,-329,354,-263,86,119,-285,358,-314,167,35,-225,342,-347,238,-52,-151,305,-359,296,-135,-69,251,-351,336,-211,17,182,-322,357,-275,103,
167,-296,357,-336,238,-86,-86,238,-336,357,-296,167,0,-167,296,-357,336,-238,86,86,-238,336,-357,296,-167,0,167,-296,357,-336,238,-86,
135,-251,329,-359,336,-263,151,-17,-119,238,-322,358,-342,275,-167,35,103,-225,314,-357,347,-285,182,-52,-86,211,-305,354,-351,296,-197,69,
103,-197,275,-329,357,-354,322,-263,182,-86,-17,119,-211,285,-336,358,-351,314,-251,167,-69,-35,135,-225,296,-342,359,-347,305,-238,151,-52,
69,-135,197,-251,296,-329,351,-359,354,-336,305,-263,211,-151,86,-17,-52,119,-182,238,-285,322,-347,358,-357,342,-314,275,-225,167,-103,35,
35,-69,103,-135,167,-197,225,-251,275,-296,314,-329,342,-351,357,-359,358,-354,347,-336,322,-305,285,-263,238,-211,182,-151,119,-86,52,-17 };


const int16_t kvz_g_iT_DST1_4[16] = { 190,308,308,190,
308,190,-190,-308,
308,-190,-190,308,
190,-308,308,-190 };

const int16_t kvz_g_iT_DST1_8[64] = { 117,219,296,336,336,296,219,117,
219,336,296,117,-117,-296,-336,-219,
296,296,0,-296,-296,0,296,296,
336,117,-296,-219,219,296,-117,-336,
336,-117,-296,219,219,-296,-117,336,
296,-296,0,296,-296,0,296,-296,
219,-336,296,-117,-117,296,-336,219,
117,-219,296,-336,336,-296,219,-117 };

const int16_t kvz_g_iT_DST1_16[256] = { 65,127,185,237,280,314,338,350,350,338,314,280,237,185,127,65,
127,237,314,350,338,280,185,65,-65,-185,-280,-338,-350,-314,-237,-127,
185,314,350,280,127,-65,-237,-338,-338,-237,-65,127,280,350,314,185,
237,350,280,65,-185,-338,-314,-127,127,314,338,185,-65,-280,-350,-237,
280,338,127,-185,-350,-237,65,314,314,65,-237,-350,-185,127,338,280,
314,280,-65,-338,-237,127,350,185,-185,-350,-127,237,338,65,-280,-314,
338,185,-237,-314,65,350,127,-280,-280,127,350,65,-314,-237,185,338,
350,65,-338,-127,314,185,-280,-237,237,280,-185,-314,127,338,-65,-350,
350,-65,-338,127,314,-185,-280,237,237,-280,-185,314,127,-338,-65,350,
338,-185,-237,314,65,-350,127,280,-280,-127,350,-65,-314,237,185,-338,
314,-280,-65,338,-237,-127,350,-185,-185,350,-127,-237,338,-65,-280,314,
280,-338,127,185,-350,237,65,-314,314,-65,-237,350,-185,-127,338,-280,
237,-350,280,-65,-185,338,-314,127,127,-314,338,-185,-65,280,-350,237,
185,-314,350,-280,127,65,-237,338,-338,237,-65,-127,280,-350,314,-185,
127,-237,314,-350,338,-280,185,-65,-65,185,-280,338,-350,314,-237,127,
65,-127,185,-237,280,-314,338,-350,350,-338,314,-280,237,-185,127,-65 };

const int16_t kvz_g_iT_DST1_32[1024] = { 34,67,100,133,163,193,220,246,269,290,309,324,337,346,353,356,356,353,346,337,324,309,290,269,246,220,193,163,133,100,67,34,
67,133,193,246,290,324,346,356,353,337,309,269,220,163,100,34,-34,-100,-163,-220,-269,-309,-337,-353,-356,-346,-324,-290,-246,-193,-133,-67,
100,193,269,324,353,353,324,269,193,100,0,-100,-193,-269,-324,-353,-353,-324,-269,-193,-100,0,100,193,269,324,353,353,324,269,193,100,
133,246,324,356,337,269,163,34,-100,-220,-309,-353,-346,-290,-193,-67,67,193,290,346,353,309,220,100,-34,-163,-269,-337,-356,-324,-246,-133,
163,290,353,337,246,100,-67,-220,-324,-356,-309,-193,-34,133,269,346,346,269,133,-34,-193,-309,-356,-324,-220,-67,100,246,337,353,290,163,
193,324,353,269,100,-100,-269,-353,-324,-193,0,193,324,353,269,100,-100,-269,-353,-324,-193,0,193,324,353,269,100,-100,-269,-353,-324,-193,
220,346,324,163,-67,-269,-356,-290,-100,133,309,353,246,34,-193,-337,-337,-193,34,246,353,309,133,-100,-290,-356,-269,-67,163,324,346,220,
246,356,269,34,-220,-353,-290,-67,193,346,309,100,-163,-337,-324,-133,133,324,337,163,-100,-309,-346,-193,67,290,353,220,-34,-269,-356,-246,
269,353,193,-100,-324,-324,-100,193,353,269,0,-269,-353,-193,100,324,324,100,-193,-353,-269,0,269,353,193,-100,-324,-324,-100,193,353,269,
290,337,100,-220,-356,-193,133,346,269,-34,-309,-324,-67,246,353,163,-163,-353,-246,67,324,309,34,-269,-346,-133,193,356,220,-100,-337,-290,
309,309,0,-309,-309,0,309,309,0,-309,-309,0,309,309,0,-309,-309,0,309,309,0,-309,-309,0,309,309,0,-309,-309,0,309,309,
324,269,-100,-353,-193,193,353,100,-269,-324,0,324,269,-100,-353,-193,193,353,100,-269,-324,0,324,269,-100,-353,-193,193,353,100,-269,-324,
337,220,-193,-346,-34,324,246,-163,-353,-67,309,269,-133,-356,-100,290,290,-100,-356,-133,269,309,-67,-353,-163,246,324,-34,-346,-193,220,337,
346,163,-269,-290,133,353,34,-337,-193,246,309,-100,-356,-67,324,220,-220,-324,67,356,100,-309,-246,193,337,-34,-353,-133,290,269,-163,-346,
353,100,-324,-193,269,269,-193,-324,100,353,0,-353,-100,324,193,-269,-269,193,324,-100,-353,0,353,100,-324,-193,269,269,-193,-324,100,353,
356,34,-353,-67,346,100,-337,-133,324,163,-309,-193,290,220,-269,-246,246,269,-220,-290,193,309,-163,-324,133,337,-100,-346,67,353,-34,-356,
356,-34,-353,67,346,-100,-337,133,324,-163,-309,193,290,-220,-269,246,246,-269,-220,290,193,-309,-163,324,133,-337,-100,346,67,-353,-34,356,
353,-100,-324,193,269,-269,-193,324,100,-353,0,353,-100,-324,193,269,-269,-193,324,100,-353,0,353,-100,-324,193,269,-269,-193,324,100,-353,
346,-163,-269,290,133,-353,34,337,-193,-246,309,100,-356,67,324,-220,-220,324,67,-356,100,309,-246,-193,337,34,-353,133,290,-269,-163,346,
337,-220,-193,346,-34,-324,246,163,-353,67,309,-269,-133,356,-100,-290,290,100,-356,133,269,-309,-67,353,-163,-246,324,34,-346,193,220,-337,
324,-269,-100,353,-193,-193,353,-100,-269,324,0,-324,269,100,-353,193,193,-353,100,269,-324,0,324,-269,-100,353,-193,-193,353,-100,-269,324,
309,-309,0,309,-309,0,309,-309,0,309,-309,0,309,-309,0,309,-309,0,309,-309,0,309,-309,0,309,-309,0,309,-309,0,309,-309,
290,-337,100,220,-356,193,133,-346,269,34,-309,324,-67,-246,353,-163,-163,353,-246,-67,324,-309,34,269,-346,133,193,-356,220,100,-337,290,
269,-353,193,100,-324,324,-100,-193,353,-269,0,269,-353,193,100,-324,324,-100,-193,353,-269,0,269,-353,193,100,-324,324,-100,-193,353,-269,
246,-356,269,-34,-220,353,-290,67,193,-346,309,-100,-163,337,-324,133,133,-324,337,-163,-100,309,-346,193,67,-290,353,-220,-34,269,-356,246,
220,-346,324,-163,-67,269,-356,290,-100,-133,309,-353,246,-34,-193,337,-337,193,34,-246,353,-309,133,100,-290,356,-269,67,163,-324,346,-220,
193,-324,353,-269,100,100,-269,353,-324,193,0,-193,324,-353,269,-100,-100,269,-353,324,-193,0,193,-324,353,-269,100,100,-269,353,-324,193,
163,-290,353,-337,246,-100,-67,220,-324,356,-309,193,-34,-133,269,-346,346,-269,133,34,-193,309,-356,324,-220,67,100,-246,337,-353,290,-163,
133,-246,324,-356,337,-269,163,-34,-100,220,-309,353,-346,290,-193,67,67,-193,290,-346,353,-309,220,-100,-34,163,-269,337,-356,324,-246,133,
100,-193,269,-324,353,-353,324,-269,193,-100,0,100,-193,269,-324,353,-353,324,-269,193,-100,0,100,-193,269,-324,353,-353,324,-269,193,-100,
67,-133,193,-246,290,-324,346,-356,353,-337,309,-269,220,-163,100,-34,-34,100,-163,220,-269,309,-337,353,-356,346,-324,290,-246,193,-133,67,
34,-67,100,-133,163,-193,220,-246,269,-290,309,-324,337,-346,353,-356,356,-353,346,-337,324,-309,290,-269,246,-220,193,-163,133,-100,67,-34 };

const int16_t kvz_g_iT_DCT5_4[16] = { 194,274,274,274,
274,241,-86,-349,
274,-86,-349,241,
274,-349,241,-86 };

const int16_t kvz_g_iT_DCT5_8[64] = { 187,264,264,264,264,264,264,264,
264,342,250,116,-39,-187,-303,-366,
264,250,-39,-303,-366,-187,116,342,
264,116,-303,-303,116,374,116,-303,
264,-39,-366,116,342,-187,-303,250,
264,-187,-187,374,-187,-187,374,-187,
264,-303,116,116,-303,374,-303,116,
264,-366,342,-303,250,-187,116,-39 };

const int16_t kvz_g_iT_DCT5_16[256] = { 184,260,260,260,260,260,260,260,260,260,260,260,260,260,260,260,
260,360,338,302,253,195,128,56,-19,-92,-162,-225,-279,-322,-351,-366,
260,338,253,128,-19,-162,-279,-351,-366,-322,-225,-92,56,195,302,360,
260,302,128,-92,-279,-366,-322,-162,56,253,360,338,195,-19,-225,-351,
260,253,-19,-279,-366,-225,56,302,360,195,-92,-322,-351,-162,128,338,
260,195,-162,-366,-225,128,360,253,-92,-351,-279,56,338,302,-19,-322,
260,128,-279,-322,56,360,195,-225,-351,-19,338,253,-162,-366,-92,302,
260,56,-351,-162,302,253,-225,-322,128,360,-19,-366,-92,338,195,-279,
260,-19,-366,56,360,-92,-351,128,338,-162,-322,195,302,-225,-279,253,
260,-92,-322,253,195,-351,-19,360,-162,-279,302,128,-366,56,338,-225,
260,-162,-225,360,-92,-279,338,-19,-322,302,56,-351,253,128,-366,195,
260,-225,-92,338,-322,56,253,-366,195,128,-351,302,-19,-279,360,-162,
260,-279,56,195,-351,338,-162,-92,302,-366,253,-19,-225,360,-322,128,
260,-322,195,-19,-162,302,-366,338,-225,56,128,-279,360,-351,253,-92,
260,-351,302,-225,128,-19,-92,195,-279,338,-366,360,-322,253,-162,56,
260,-366,360,-351,338,-322,302,-279,253,-225,195,-162,128,-92,56,-19 };

const int16_t kvz_g_iT_DCT5_32[1024] = { 182,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,258,
258,363,358,349,336,320,301,280,255,228,198,166,133,99,63,27,-9,-45,-81,-116,-150,-182,-213,-241,-267,-291,-311,-329,-343,-354,-361,-364,
258,358,336,301,255,198,133,63,-9,-81,-150,-213,-267,-311,-343,-361,-364,-354,-329,-291,-241,-182,-116,-45,27,99,166,228,280,320,349,363,
258,349,301,228,133,27,-81,-182,-267,-329,-361,-361,-329,-267,-182,-81,27,133,228,301,349,365,349,301,228,133,27,-81,-182,-267,-329,-361,
258,336,255,133,-9,-150,-267,-343,-364,-329,-241,-116,27,166,280,349,363,320,228,99,-45,-182,-291,-354,-361,-311,-213,-81,63,198,301,358,
258,320,198,27,-150,-291,-361,-343,-241,-81,99,255,349,358,280,133,-45,-213,-329,-364,-311,-182,-9,166,301,363,336,228,63,-116,-267,-354,
258,301,133,-81,-267,-361,-329,-182,27,228,349,349,228,27,-182,-329,-361,-267,-81,133,301,365,301,133,-81,-267,-361,-329,-182,27,228,349,
258,280,63,-182,-343,-343,-182,63,280,365,280,63,-182,-343,-343,-182,63,280,365,280,63,-182,-343,-343,-182,63,280,365,280,63,-182,-343,
258,255,-9,-267,-364,-241,27,280,363,228,-45,-291,-361,-213,63,301,358,198,-81,-311,-354,-182,99,320,349,166,-116,-329,-343,-150,133,336,
258,228,-81,-329,-329,-81,228,365,228,-81,-329,-329,-81,228,365,228,-81,-329,-329,-81,228,365,228,-81,-329,-329,-81,228,365,228,-81,-329,
258,198,-150,-361,-241,99,349,280,-45,-329,-311,-9,301,336,63,-267,-354,-116,228,363,166,-182,-364,-213,133,358,255,-81,-343,-291,27,320,
258,166,-213,-361,-116,255,349,63,-291,-329,-9,320,301,-45,-343,-267,99,358,228,-150,-364,-182,198,363,133,-241,-354,-81,280,336,27,-311,
258,133,-267,-329,27,349,228,-182,-361,-81,301,301,-81,-361,-182,228,349,27,-329,-267,133,365,133,-267,-329,27,349,228,-182,-361,-81,301,
258,99,-311,-267,166,358,27,-343,-213,228,336,-45,-361,-150,280,301,-116,-364,-81,320,255,-182,-354,-9,349,198,-241,-329,63,363,133,-291,
258,63,-343,-182,280,280,-182,-343,63,365,63,-343,-182,280,280,-182,-343,63,365,63,-343,-182,280,280,-182,-343,63,365,63,-343,-182,280,
258,27,-361,-81,349,133,-329,-182,301,228,-267,-267,228,301,-182,-329,133,349,-81,-361,27,365,27,-361,-81,349,133,-329,-182,301,228,-267,
258,-9,-364,27,363,-45,-361,63,358,-81,-354,99,349,-116,-343,133,336,-150,-329,166,320,-182,-311,198,301,-213,-291,228,280,-241,-267,255,
258,-45,-354,133,320,-213,-267,280,198,-329,-116,358,27,-364,63,349,-150,-311,228,255,-291,-182,336,99,-361,-9,363,-81,-343,166,301,-241,
258,-81,-329,228,228,-329,-81,365,-81,-329,228,228,-329,-81,365,-81,-329,228,228,-329,-81,365,-81,-329,228,228,-329,-81,365,-81,-329,228,
258,-116,-291,301,99,-364,133,280,-311,-81,363,-150,-267,320,63,-361,166,255,-329,-45,358,-182,-241,336,27,-354,198,228,-343,-9,349,-213,
258,-150,-241,349,-45,-311,301,63,-354,228,166,-364,133,255,-343,27,320,-291,-81,358,-213,-182,363,-116,-267,336,-9,-329,280,99,-361,198,
258,-182,-182,365,-182,-182,365,-182,-182,365,-182,-182,365,-182,-182,365,-182,-182,365,-182,-182,365,-182,-182,365,-182,-182,365,-182,-182,365,-182,
258,-213,-116,349,-291,-9,301,-343,99,228,-364,198,133,-354,280,27,-311,336,-81,-241,363,-182,-150,358,-267,-45,320,-329,63,255,-361,166,
258,-241,-45,301,-354,166,133,-343,320,-81,-213,363,-267,-9,280,-361,198,99,-329,336,-116,-182,358,-291,27,255,-364,228,63,-311,349,-150,
258,-267,27,228,-361,301,-81,-182,349,-329,133,133,-329,349,-182,-81,301,-361,228,27,-267,365,-267,27,228,-361,301,-81,-182,349,-329,133,
258,-291,99,133,-311,363,-267,63,166,-329,358,-241,27,198,-343,349,-213,-9,228,-354,336,-182,-45,255,-361,320,-150,-81,280,-364,301,-116,
258,-311,166,27,-213,336,-361,280,-116,-81,255,-354,349,-241,63,133,-291,363,-329,198,-9,-182,320,-364,301,-150,-45,228,-343,358,-267,99,
258,-329,228,-81,-81,228,-329,365,-329,228,-81,-81,228,-329,365,-329,228,-81,-81,228,-329,365,-329,228,-81,-81,228,-329,365,-329,228,-81,
258,-343,280,-182,63,63,-182,280,-343,365,-343,280,-182,63,63,-182,280,-343,365,-343,280,-182,63,63,-182,280,-343,365,-343,280,-182,63,
258,-354,320,-267,198,-116,27,63,-150,228,-291,336,-361,363,-343,301,-241,166,-81,-9,99,-182,255,-311,349,-364,358,-329,280,-213,133,-45,
258,-361,349,-329,301,-267,228,-182,133,-81,27,27,-81,133,-182,228,-267,301,-329,349,-361,365,-361,349,-329,301,-267,228,-182,133,-81,27,
258,-364,363,-361,358,-354,349,-343,336,-329,320,-311,301,-291,280,-267,255,-241,228,-213,198,-182,166,-150,133,-116,99,-81,63,-45,27,-9 };

const int16_t kvz_g_iT_DCT8_4[16] = { 336,296,219,117,
296,0,-296,-296,
219,-296,-117,336,
117,-296,336,-219 };

const int16_t kvz_g_iT_DCT8_8[64] = { 350,338,314,280,237,185,127,65,
338,237,65,-127,-280,-350,-314,-185,
314,65,-237,-350,-185,127,338,280,
280,-127,-350,-65,314,237,-185,-338,
237,-280,-185,314,127,-338,-65,350,
185,-350,127,237,-338,65,280,-314,
127,-314,338,-185,-65,280,-350,237,
65,-185,280,-338,350,-314,237,-127 };

const int16_t kvz_g_iT_DCT8_16[256] = { 356,353,346,337,324,309,290,269,246,220,193,163,133,100,67,34,
353,324,269,193,100,0,-100,-193,-269,-324,-353,-353,-324,-269,-193,-100,
346,269,133,-34,-193,-309,-356,-324,-220,-67,100,246,337,353,290,163,
337,193,-34,-246,-353,-309,-133,100,290,356,269,67,-163,-324,-346,-220,
324,100,-193,-353,-269,0,269,353,193,-100,-324,-324,-100,193,353,269,
309,0,-309,-309,0,309,309,0,-309,-309,0,309,309,0,-309,-309,
290,-100,-356,-133,269,309,-67,-353,-163,246,324,-34,-346,-193,220,337,
269,-193,-324,100,353,0,-353,-100,324,193,-269,-269,193,324,-100,-353,
246,-269,-220,290,193,-309,-163,324,133,-337,-100,346,67,-353,-34,356,
220,-324,-67,356,-100,-309,246,193,-337,-34,353,-133,-290,269,163,-346,
193,-353,100,269,-324,0,324,-269,-100,353,-193,-193,353,-100,-269,324,
163,-353,246,67,-324,309,-34,-269,346,-133,-193,356,-220,-100,337,-290,
133,-324,337,-163,-100,309,-346,193,67,-290,353,-220,-34,269,-356,246,
100,-269,353,-324,193,0,-193,324,-353,269,-100,-100,269,-353,324,-193,
67,-193,290,-346,353,-309,220,-100,-34,163,-269,337,-356,324,-246,133,
34,-100,163,-220,269,-309,337,-353,356,-346,324,-290,246,-193,133,-67 };

const int16_t kvz_g_iT_DCT8_32[1024] = { 359,358,357,354,351,347,342,336,329,322,314,305,296,285,275,263,251,238,225,211,197,182,167,151,135,119,103,86,69,52,35,17,
358,351,336,314,285,251,211,167,119,69,17,-35,-86,-135,-182,-225,-263,-296,-322,-342,-354,-359,-357,-347,-329,-305,-275,-238,-197,-151,-103,-52,
357,336,296,238,167,86,0,-86,-167,-238,-296,-336,-357,-357,-336,-296,-238,-167,-86,0,86,167,238,296,336,357,357,336,296,238,167,86,
354,314,238,135,17,-103,-211,-296,-347,-358,-329,-263,-167,-52,69,182,275,336,359,342,285,197,86,-35,-151,-251,-322,-357,-351,-305,-225,-119,
351,285,167,17,-135,-263,-342,-357,-305,-197,-52,103,238,329,359,322,225,86,-69,-211,-314,-358,-336,-251,-119,35,182,296,354,347,275,151,
347,251,86,-103,-263,-351,-342,-238,-69,119,275,354,336,225,52,-135,-285,-357,-329,-211,-35,151,296,358,322,197,17,-167,-305,-359,-314,-182,
342,211,0,-211,-342,-342,-211,0,211,342,342,211,0,-211,-342,-342,-211,0,211,342,342,211,0,-211,-342,-342,-211,0,211,342,342,211,
336,167,-86,-296,-357,-238,0,238,357,296,86,-167,-336,-336,-167,86,296,357,238,0,-238,-357,-296,-86,167,336,336,167,-86,-296,-357,-238,
329,119,-167,-347,-305,-69,211,357,275,17,-251,-359,-238,35,285,354,197,-86,-314,-342,-151,135,336,322,103,-182,-351,-296,-52,225,358,263,
322,69,-238,-358,-197,119,342,296,17,-275,-351,-151,167,354,263,-35,-305,-336,-103,211,359,225,-86,-329,-314,-52,251,357,182,-135,-347,-285,
314,17,-296,-329,-52,275,342,86,-251,-351,-119,225,357,151,-197,-359,-182,167,358,211,-135,-354,-238,103,347,263,-69,-336,-285,35,322,305,
305,-35,-336,-263,103,354,211,-167,-359,-151,225,351,86,-275,-329,-17,314,296,-52,-342,-251,119,357,197,-182,-358,-135,238,347,69,-285,-322,
296,-86,-357,-167,238,336,0,-336,-238,167,357,86,-296,-296,86,357,167,-238,-336,0,336,238,-167,-357,-86,296,296,-86,-357,-167,238,336,
285,-135,-357,-52,329,225,-211,-336,35,354,151,-275,-296,119,358,69,-322,-238,197,342,-17,-351,-167,263,305,-103,-359,-86,314,251,-182,-347,
275,-182,-336,69,359,52,-342,-167,285,263,-197,-329,86,358,35,-347,-151,296,251,-211,-322,103,357,17,-351,-135,305,238,-225,-314,119,354,
263,-225,-296,182,322,-135,-342,86,354,-35,-359,-17,357,69,-347,-119,329,167,-305,-211,275,251,-238,-285,197,314,-151,-336,103,351,-52,-358,
251,-263,-238,275,225,-285,-211,296,197,-305,-182,314,167,-322,-151,329,135,-336,-119,342,103,-347,-86,351,69,-354,-52,357,35,-358,-17,359,
238,-296,-167,336,86,-357,0,357,-86,-336,167,296,-238,-238,296,167,-336,-86,357,0,-357,86,336,-167,-296,238,238,-296,-167,336,86,-357,
225,-322,-86,359,-69,-329,211,238,-314,-103,358,-52,-336,197,251,-305,-119,357,-35,-342,182,263,-296,-135,354,-17,-347,167,275,-285,-151,351,
211,-342,0,342,-211,-211,342,0,-342,211,211,-342,0,342,-211,-211,342,0,-342,211,211,-342,0,342,-211,-211,342,0,-342,211,211,-342,
197,-354,86,285,-314,-35,342,-238,-151,359,-135,-251,336,-17,-322,275,103,-357,182,211,-351,69,296,-305,-52,347,-225,-167,358,-119,-263,329,
182,-359,167,197,-358,151,211,-357,135,225,-354,119,238,-351,103,251,-347,86,263,-342,69,275,-336,52,285,-329,35,296,-322,17,305,-314,
167,-357,238,86,-336,296,0,-296,336,-86,-238,357,-167,-167,357,-238,-86,336,-296,0,296,-336,86,238,-357,167,167,-357,238,86,-336,296,
151,-347,296,-35,-251,358,-211,-86,322,-329,103,197,-357,263,17,-285,351,-167,-135,342,-305,52,238,-359,225,69,-314,336,-119,-182,354,-275,
135,-329,336,-151,-119,322,-342,167,103,-314,347,-182,-86,305,-351,197,69,-296,354,-211,-52,285,-357,225,35,-275,358,-238,-17,263,-359,251,
119,-305,357,-251,35,197,-342,336,-182,-52,263,-358,296,-103,-135,314,-354,238,-17,-211,347,-329,167,69,-275,359,-285,86,151,-322,351,-225,
103,-275,357,-322,182,17,-211,336,-351,251,-69,-135,296,-359,305,-151,-52,238,-347,342,-225,35,167,-314,358,-285,119,86,-263,354,-329,197,
86,-238,336,-357,296,-167,0,167,-296,357,-336,238,-86,-86,238,-336,357,-296,167,0,-167,296,-357,336,-238,86,86,-238,336,-357,296,-167,
69,-197,296,-351,354,-305,211,-86,-52,182,-285,347,-357,314,-225,103,35,-167,275,-342,358,-322,238,-119,-17,151,-263,336,-359,329,-251,135,
52,-151,238,-305,347,-359,342,-296,225,-135,35,69,-167,251,-314,351,-358,336,-285,211,-119,17,86,-182,263,-322,354,-357,329,-275,197,-103,
35,-103,167,-225,275,-314,342,-357,358,-347,322,-285,238,-182,119,-52,-17,86,-151,211,-263,305,-336,354,-359,351,-329,296,-251,197,-135,69,
17,-52,86,-119,151,-182,211,-238,263,-285,305,-322,336,-347,354,-358,359,-357,351,-342,329,-314,296,-275,251,-225,197,-167,135,-103,69,-35 };


static void fastForwardDCT2_B4(const int16_t* src, int16_t* dst, int32_t shift) {

  int32_t j;
  int32_t E[2], O[2];
  int32_t add = 1 << (shift - 1);
  const int32_t line = 4;  // for square blocks

  for (j = 0; j < line; j++) {
    /* E and O */
    E[0] = src[0] + src[3];
    O[0] = src[0] - src[3];
    E[1] = src[1] + src[2];
    O[1] = src[1] - src[2];

    dst[0] = (kvz_g_iT_DCT2_4[0] * E[0] + kvz_g_iT_DCT2_4[1] * E[1] + add) >> shift;
    dst[2 * line] = (kvz_g_iT_DCT2_4[8] * E[0] + kvz_g_iT_DCT2_4[9] * E[1] + add) >> shift;
    dst[line] = (kvz_g_iT_DCT2_4[4] * O[0] + kvz_g_iT_DCT2_4[5] * O[1] + add) >> shift;
    dst[3 * line] = (kvz_g_iT_DCT2_4[12] * O[0] + kvz_g_iT_DCT2_4[13] * O[1] + add) >> shift;

    src += 4;
    dst++;
  }
}

//void fastForwardDCT2_B8(int32_t *src ,int32_t *dst,int32_t shift, int32_t line)
static void fastForwardDCT2_B8(const int16_t* src, int16_t* dst, int32_t shift) {

  int32_t j, k;
  int32_t E[4], O[4];
  int32_t EE[2], EO[2];
  int32_t add = 1 << (shift - 1);
  const int32_t line = 8;  // for square blocks


  for (j = 0; j < line; j++) {
    /* E and O*/
    for (k = 0; k < 4; k++) {
      E[k] = src[k] + src[7 - k];
      O[k] = src[k] - src[7 - k];
    }
    /* EE and EO */
    EE[0] = E[0] + E[3];
    EO[0] = E[0] - E[3];
    EE[1] = E[1] + E[2];
    EO[1] = E[1] - E[2];

    dst[0] = (kvz_g_iT_DCT2_8[0] * EE[0] + kvz_g_iT_DCT2_8[1] * EE[1] + add) >> shift;
    dst[4 * line] = (kvz_g_iT_DCT2_8[32] * EE[0] + kvz_g_iT_DCT2_8[33] * EE[1] + add) >> shift;
    dst[2 * line] = (kvz_g_iT_DCT2_8[16] * EO[0] + kvz_g_iT_DCT2_8[17] * EO[1] + add) >> shift;
    dst[6 * line] = (kvz_g_iT_DCT2_8[48] * EO[0] + kvz_g_iT_DCT2_8[49] * EO[1] + add) >> shift;

    dst[line] = (kvz_g_iT_DCT2_8[8] * O[0] + kvz_g_iT_DCT2_8[9] * O[1] + kvz_g_iT_DCT2_8[10] * O[2] + kvz_g_iT_DCT2_8[11] * O[3] + add) >> shift;
    dst[3 * line] = (kvz_g_iT_DCT2_8[24] * O[0] + kvz_g_iT_DCT2_8[25] * O[1] + kvz_g_iT_DCT2_8[26] * O[2] + kvz_g_iT_DCT2_8[27] * O[3] + add) >> shift;
    dst[5 * line] = (kvz_g_iT_DCT2_8[40] * O[0] + kvz_g_iT_DCT2_8[41] * O[1] + kvz_g_iT_DCT2_8[42] * O[2] + kvz_g_iT_DCT2_8[43] * O[3] + add) >> shift;
    dst[7 * line] = (kvz_g_iT_DCT2_8[56] * O[0] + kvz_g_iT_DCT2_8[57] * O[1] + kvz_g_iT_DCT2_8[58] * O[2] + kvz_g_iT_DCT2_8[59] * O[3] + add) >> shift;

    src += 8;
    dst++;
  }
}

//void fastForwardDCT2_B16(int32_t *src ,int32_t *dst,int32_t shift, int32_t line)// for non square blocks
static void fastForwardDCT2_B16(const int16_t* src, int16_t* dst, int32_t shift) {

  int32_t j, k;
  int32_t E[8], O[8];
  int32_t EE[4], EO[4];
  int32_t EEE[2], EEO[2];
  int32_t add = 1 << (shift - 1);
  const int32_t line = 16;  // for square blocks

  for (j = 0; j < line; j++) {
    /* E and O*/
    for (k = 0; k < 8; k++) {
      E[k] = src[k] + src[15 - k];
      O[k] = src[k] - src[15 - k];
    }
    /* EE and EO */
    for (k = 0; k < 4; k++) {
      EE[k] = E[k] + E[7 - k];
      EO[k] = E[k] - E[7 - k];
    }
    /* EEE and EEO */
    EEE[0] = EE[0] + EE[3];
    EEO[0] = EE[0] - EE[3];
    EEE[1] = EE[1] + EE[2];
    EEO[1] = EE[1] - EE[2];

    dst[0] = (kvz_g_iT_DCT2_16[0] * EEE[0] + kvz_g_iT_DCT2_16[1] * EEE[1] + add) >> shift;
    dst[8 * line] = (kvz_g_iT_DCT2_16[8 * 16] * EEE[0] + kvz_g_iT_DCT2_16[8 * 16 + 1] * EEE[1] + add) >> shift;
    dst[4 * line] = (kvz_g_iT_DCT2_16[4 * 16] * EEO[0] + kvz_g_iT_DCT2_16[4 * 16 + 1] * EEO[1] + add) >> shift;
    dst[12 * line] = (kvz_g_iT_DCT2_16[12 * 16] * EEO[0] + kvz_g_iT_DCT2_16[12 * 16 + 1] * EEO[1] + add) >> shift;

    for (k = 2; k < 16; k += 4) {
      dst[k * line] = (kvz_g_iT_DCT2_16[k * 16] * EO[0] + kvz_g_iT_DCT2_16[k * 16 + 1] * EO[1] + kvz_g_iT_DCT2_16[k * 16 + 2] * EO[2] + kvz_g_iT_DCT2_16[k * 16 + 3] * EO[3] + add) >> shift;
    }

    for (k = 1; k < 16; k += 2) {
      dst[k * line] = (kvz_g_iT_DCT2_16[k * 16] * O[0] + kvz_g_iT_DCT2_16[k * 16 + 1] * O[1] + kvz_g_iT_DCT2_16[k * 16 + 2] * O[2] + kvz_g_iT_DCT2_16[k * 16 + 3] * O[3] +
        kvz_g_iT_DCT2_16[k * 16 + 4] * O[4] + kvz_g_iT_DCT2_16[k * 16 + 5] * O[5] + kvz_g_iT_DCT2_16[k * 16 + 6] * O[6] + kvz_g_iT_DCT2_16[k * 16 + 7] * O[7] + add) >> shift;
    }

    src += 16;
    dst++;

  }
}

//void fastForwardDCT2_B32(int32_t *src ,int32_t *dst,int32_t shift, int32_t line)
static void fastForwardDCT2_B32(const int16_t* src, int16_t* dst, int32_t shift) {

  int32_t j, k;
  int32_t E[16], O[16];
  int32_t EE[8], EO[8];
  int32_t EEE[4], EEO[4];
  int32_t EEEE[2], EEEO[2];
  int32_t add = 1 << (shift - 1);
  const int32_t line = 32;  // for square blocks

  for (j = 0; j < line; j++) {
    /* E and O*/
    for (k = 0; k < 16; k++) {
      E[k] = src[k] + src[31 - k];
      O[k] = src[k] - src[31 - k];
    }
    /* EE and EO */
    for (k = 0; k < 8; k++) {
      EE[k] = E[k] + E[15 - k];
      EO[k] = E[k] - E[15 - k];
    }
    /* EEE and EEO */
    for (k = 0; k < 4; k++) {
      EEE[k] = EE[k] + EE[7 - k];
      EEO[k] = EE[k] - EE[7 - k];
    }
    /* EEEE and EEEO */
    EEEE[0] = EEE[0] + EEE[3];
    EEEO[0] = EEE[0] - EEE[3];
    EEEE[1] = EEE[1] + EEE[2];
    EEEO[1] = EEE[1] - EEE[2];

    dst[0] = (kvz_g_iT_DCT2_32[0 * 32 + 0] * EEEE[0] + kvz_g_iT_DCT2_32[0 * 32 + 1] * EEEE[1] + add) >> shift;
    dst[16 * line] = (kvz_g_iT_DCT2_32[16 * 32 + 0] * EEEE[0] + kvz_g_iT_DCT2_32[16 * 32 + 1] * EEEE[1] + add) >> shift;
    dst[8 * line] = (kvz_g_iT_DCT2_32[8 * 32 + 0] * EEEO[0] + kvz_g_iT_DCT2_32[8 * 32 + 1] * EEEO[1] + add) >> shift;
    dst[24 * line] = (kvz_g_iT_DCT2_32[24 * 32 + 0] * EEEO[0] + kvz_g_iT_DCT2_32[24 * 32 + 1] * EEEO[1] + add) >> shift;
    for (k = 4; k < 32; k += 8) {
      dst[k * line] = (kvz_g_iT_DCT2_32[k * 32 + 0] * EEO[0] + kvz_g_iT_DCT2_32[k * 32 + 1] * EEO[1] + kvz_g_iT_DCT2_32[k * 32 + 2] * EEO[2] + kvz_g_iT_DCT2_32[k * 32 + 3] * EEO[3] + add) >> shift;
    }
    for (k = 2; k < 32; k += 4) {
      dst[k * line] = (kvz_g_iT_DCT2_32[k * 32 + 0] * EO[0] + kvz_g_iT_DCT2_32[k * 32 + 1] * EO[1] + kvz_g_iT_DCT2_32[k * 32 + 2] * EO[2] + kvz_g_iT_DCT2_32[k * 32 + 3] * EO[3] +
        kvz_g_iT_DCT2_32[k * 32 + 4] * EO[4] + kvz_g_iT_DCT2_32[k * 32 + 5] * EO[5] + kvz_g_iT_DCT2_32[k * 32 + 6] * EO[6] + kvz_g_iT_DCT2_32[k * 32 + 7] * EO[7] + add) >> shift;
    }
    for (k = 1; k < 32; k += 2) {
      dst[k * line] = (kvz_g_iT_DCT2_32[k * 32 + 0] * O[0] + kvz_g_iT_DCT2_32[k * 32 + 1] * O[1] + kvz_g_iT_DCT2_32[k * 32 + 2] * O[2] + kvz_g_iT_DCT2_32[k * 32 + 3] * O[3] +
        kvz_g_iT_DCT2_32[k * 32 + 4] * O[4] + kvz_g_iT_DCT2_32[k * 32 + 5] * O[5] + kvz_g_iT_DCT2_32[k * 32 + 6] * O[6] + kvz_g_iT_DCT2_32[k * 32 + 7] * O[7] +
        kvz_g_iT_DCT2_32[k * 32 + 8] * O[8] + kvz_g_iT_DCT2_32[k * 32 + 9] * O[9] + kvz_g_iT_DCT2_32[k * 32 + 10] * O[10] + kvz_g_iT_DCT2_32[k * 32 + 11] * O[11] +
        kvz_g_iT_DCT2_32[k * 32 + 12] * O[12] + kvz_g_iT_DCT2_32[k * 32 + 13] * O[13] + kvz_g_iT_DCT2_32[k * 32 + 14] * O[14] + kvz_g_iT_DCT2_32[k * 32 + 15] * O[15] + add) >> shift;
    }
    src += 32;
    dst++;
  }
}


static void fastInverseDCT2_B4(const int16_t* src, int16_t* dst, int32_t shift)
// void fastInverseDCT2_B4(int32_t *src, int32_t *dst, int32_t shift, int32_t line)    // for non square blocks
{
  int32_t j;
  int32_t E[2], O[2];
  int32_t add = 1 << (shift - 1);
  const int32_t line = 4;  // for square blocks



  for (j = 0; j < line; j++)

  {
    /* Utilizing symmetry properties to the maximum to minimize the number of multiplications */
    O[0] = kvz_g_iT_DCT2_4[1 * 4 + 0] * src[line] + kvz_g_iT_DCT2_4[3 * 4 + 0] * src[3 * line];
    O[1] = kvz_g_iT_DCT2_4[1 * 4 + 1] * src[line] + kvz_g_iT_DCT2_4[3 * 4 + 1] * src[3 * line];
    E[0] = kvz_g_iT_DCT2_4[0 * 4 + 0] * src[0] + kvz_g_iT_DCT2_4[2 * 4 + 0] * src[2 * line];
    E[1] = kvz_g_iT_DCT2_4[0 * 4 + 1] * src[0] + kvz_g_iT_DCT2_4[2 * 4 + 1] * src[2 * line];

    /* Combining even and odd terms at each hierarchy levels to calculate the final spatial domain vector */
    dst[0] = (short)CLIP(-32768, 32767, (E[0] + O[0] + add) >> shift);
    dst[1] = (short)CLIP(-32768, 32767, (E[1] + O[1] + add) >> shift);
    dst[2] = (short)CLIP(-32768, 32767, (E[1] - O[1] + add) >> shift);
    dst[3] = (short)CLIP(-32768, 32767, (E[0] - O[0] + add) >> shift);

    src++;
    dst += 4;
  }

}


static void fastInverseDCT2_B8(const int16_t* src, int16_t* dst, int32_t shift) {
  int32_t j, k;
  int32_t E[4], O[4];
  int32_t EE[2], EO[2];
  int32_t add = 1 << (shift - 1);

  const int32_t line = 8;  // for square blocks

  for (j = 0; j < line; j++) {
    /* Utilizing symmetry properties to the maximum to minimize the number of multiplications */
    for (k = 0; k < 4; k++) {
      O[k] = kvz_g_iT_DCT2_8[1 * 8 + k] * src[line] + kvz_g_iT_DCT2_8[3 * 8 + k] * src[3 * line] + kvz_g_iT_DCT2_8[5 * 8 + k] * src[5 * line] + kvz_g_iT_DCT2_8[7 * 8 + k] * src[7 * line];
    }

    EO[0] = kvz_g_iT_DCT2_8[2 * 8 + 0] * src[2 * line] + kvz_g_iT_DCT2_8[6 * 8 + 0] * src[6 * line];
    EO[1] = kvz_g_iT_DCT2_8[2 * 8 + 1] * src[2 * line] + kvz_g_iT_DCT2_8[6 * 8 + 1] * src[6 * line];
    EE[0] = kvz_g_iT_DCT2_8[0 * 8 + 0] * src[0] + kvz_g_iT_DCT2_8[4 * 8 + 0] * src[4 * line];
    EE[1] = kvz_g_iT_DCT2_8[0 * 8 + 1] * src[0] + kvz_g_iT_DCT2_8[4 * 8 + 1] * src[4 * line];

    /* Combining even and odd terms at each hierarchy levels to calculate the final spatial domain vector */
    E[0] = EE[0] + EO[0];
    E[3] = EE[0] - EO[0];
    E[1] = EE[1] + EO[1];
    E[2] = EE[1] - EO[1];
    for (k = 0; k < 4; k++) {
      dst[k] = (short)CLIP(-32768, 32767, (E[k] + O[k] + add) >> shift);
      dst[k + 4] = (short)CLIP(-32768, 32767, (E[3 - k] - O[3 - k] + add) >> shift);

      //  dst[k] = (E[k] + O[k]);// +add) >> shift;
      // dst[k + 4] = (E[3 - k] - O[3 - k]);// +add) >> shift;
    }
    src++;
    dst += 8;
  }
}

static void fastInverseDCT2_B16(const int16_t* src, int16_t* dst, int32_t shift) {

  int32_t j, k;
  int32_t E[8], O[8];
  int32_t EE[4], EO[4];
  int32_t EEE[2], EEO[2];
  int32_t add = 1 << (shift - 1);

  const int32_t line = 16;  // for square blocks

  for (j = 0; j < line; j++) {
    /* Utilizing symmetry properties to the maximum to minimize the number of multiplications */
    for (k = 0; k < 8; k++) {
      O[k] = kvz_g_iT_DCT2_16[1 * 16 + k] * src[line] + kvz_g_iT_DCT2_16[3 * 16 + k] * src[3 * line] + kvz_g_iT_DCT2_16[5 * 16 + k] * src[5 * line] + kvz_g_iT_DCT2_16[7 * 16 + k] * src[7 * line] +
        kvz_g_iT_DCT2_16[9 * 16 + k] * src[9 * line] + kvz_g_iT_DCT2_16[11 * 16 + k] * src[11 * line] + kvz_g_iT_DCT2_16[13 * 16 + k] * src[13 * line] + kvz_g_iT_DCT2_16[15 * 16 + k] * src[15 * line];
    }
    for (k = 0; k < 4; k++) {
      EO[k] = kvz_g_iT_DCT2_16[2 * 16 + k] * src[2 * line] + kvz_g_iT_DCT2_16[6 * 16 + k] * src[6 * line] + kvz_g_iT_DCT2_16[10 * 16 + k] * src[10 * line] + kvz_g_iT_DCT2_16[14 * 16 + k] * src[14 * line];
    }
    EEO[0] = kvz_g_iT_DCT2_16[4 * 16] * src[4 * line] + kvz_g_iT_DCT2_16[12 * 16] * src[12 * line];
    EEE[0] = kvz_g_iT_DCT2_16[0] * src[0] + kvz_g_iT_DCT2_16[8 * 16] * src[8 * line];
    EEO[1] = kvz_g_iT_DCT2_16[4 * 16 + 1] * src[4 * line] + kvz_g_iT_DCT2_16[12 * 16 + 1] * src[12 * line];
    EEE[1] = kvz_g_iT_DCT2_16[0 * 16 + 1] * src[0] + kvz_g_iT_DCT2_16[8 * 16 + 1] * src[8 * line];

    /* Combining even and odd terms at each hierarchy levels to calculate the final spatial domain vector */
    for (k = 0; k < 2; k++) {
      EE[k] = EEE[k] + EEO[k];
      EE[k + 2] = EEE[1 - k] - EEO[1 - k];
    }
    for (k = 0; k < 4; k++) {
      E[k] = EE[k] + EO[k];
      E[k + 4] = EE[3 - k] - EO[3 - k];
    }
    for (k = 0; k < 8; k++) {
      dst[k] = (short)CLIP(-32768, 32767, (E[k] + O[k] + add) >> shift);
      dst[k + 8] = (short)CLIP(-32768, 32767, (E[7 - k] - O[7 - k] + add) >> shift);
    }
    src++;
    dst += 16;
  }
}

static void fastInverseDCT2_B32(const int16_t* src, int16_t* dst, int32_t shift) {

  int32_t j, k;
  int32_t E[16], O[16];
  int32_t EE[8], EO[8];
  int32_t EEE[4], EEO[4];
  int32_t EEEE[2], EEEO[2];
  int32_t add = 1 << (shift - 1);

  const int32_t line = 32;  // for square blocks

  for (j = 0; j < line; j++) {
    /* Utilizing symmetry properties to the maximum to minimize the number of multiplications */
    for (k = 0; k < 16; k++) {
      O[k] = kvz_g_iT_DCT2_32[1 * 32 + k] * src[line] + kvz_g_iT_DCT2_32[3 * 32 + k] * src[3 * line] + kvz_g_iT_DCT2_32[5 * 32 + k] * src[5 * line] + kvz_g_iT_DCT2_32[7 * 32 + k] * src[7 * line] +
        kvz_g_iT_DCT2_32[9 * 32 + k] * src[9 * line] + kvz_g_iT_DCT2_32[11 * 32 + k] * src[11 * line] + kvz_g_iT_DCT2_32[13 * 32 + k] * src[13 * line] + kvz_g_iT_DCT2_32[15 * 32 + k] * src[15 * line] +
        kvz_g_iT_DCT2_32[17 * 32 + k] * src[17 * line] + kvz_g_iT_DCT2_32[19 * 32 + k] * src[19 * line] + kvz_g_iT_DCT2_32[21 * 32 + k] * src[21 * line] + kvz_g_iT_DCT2_32[23 * 32 + k] * src[23 * line] +
        kvz_g_iT_DCT2_32[25 * 32 + k] * src[25 * line] + kvz_g_iT_DCT2_32[27 * 32 + k] * src[27 * line] + kvz_g_iT_DCT2_32[29 * 32 + k] * src[29 * line] + kvz_g_iT_DCT2_32[31 * 32 + k] * src[31 * line];
    }
    for (k = 0; k < 8; k++) {
      EO[k] = kvz_g_iT_DCT2_32[2 * 32 + k] * src[2 * line] + kvz_g_iT_DCT2_32[6 * 32 + k] * src[6 * line] + kvz_g_iT_DCT2_32[10 * 32 + k] * src[10 * line] + kvz_g_iT_DCT2_32[14 * 32 + k] * src[14 * line] +
        kvz_g_iT_DCT2_32[18 * 32 + k] * src[18 * line] + kvz_g_iT_DCT2_32[22 * 32 + k] * src[22 * line] + kvz_g_iT_DCT2_32[26 * 32 + k] * src[26 * line] + kvz_g_iT_DCT2_32[30 * 32 + k] * src[30 * line];
    }
    for (k = 0; k < 4; k++) {
      EEO[k] = kvz_g_iT_DCT2_32[4 * 32 + k] * src[4 * line] + kvz_g_iT_DCT2_32[12 * 32 + k] * src[12 * line] + kvz_g_iT_DCT2_32[20 * 32 + k] * src[20 * line] + kvz_g_iT_DCT2_32[28 * 32 + k] * src[28 * line];
    }
    EEEO[0] = kvz_g_iT_DCT2_32[8 * 32 + 0] * src[8 * line] + kvz_g_iT_DCT2_32[24 * 32 + 0] * src[24 * line];
    EEEO[1] = kvz_g_iT_DCT2_32[8 * 32 + 1] * src[8 * line] + kvz_g_iT_DCT2_32[24 * 32 + 1] * src[24 * line];
    EEEE[0] = kvz_g_iT_DCT2_32[0 * 32 + 0] * src[0] + kvz_g_iT_DCT2_32[16 * 32 + 0] * src[16 * line];
    EEEE[1] = kvz_g_iT_DCT2_32[0 * 32 + 1] * src[0] + kvz_g_iT_DCT2_32[16 * 32 + 1] * src[16 * line];

    /* Combining even and odd terms at each hierarchy levels to calculate the final spatial domain vector */
    EEE[0] = EEEE[0] + EEEO[0];
    EEE[3] = EEEE[0] - EEEO[0];
    EEE[1] = EEEE[1] + EEEO[1];
    EEE[2] = EEEE[1] - EEEO[1];
    for (k = 0; k < 4; k++) {
      EE[k] = EEE[k] + EEO[k];
      EE[k + 4] = EEE[3 - k] - EEO[3 - k];
    }
    for (k = 0; k < 8; k++) {
      E[k] = EE[k] + EO[k];
      E[k + 8] = EE[7 - k] - EO[7 - k];
    }
    for (k = 0; k < 16; k++) {
      dst[k] = (short)CLIP(-32768, 32767, (E[k] + O[k] + add) >> shift);
      dst[k + 16] = (short)CLIP(-32768, 32767, (E[15 - k] - O[15 - k] + add) >> shift);
    }
    src++;
    dst += 32;
  }
}

static void fastForwardDST7_B4(const int16_t* block, int16_t* coeff, int32_t shift) {
  int32_t i;
  int32_t rnd_factor = 1 << (shift - 1);
  int32_t c[4];
  const int32_t line = 4;  // for square blocks


  for (i = 0; i < line; i++) {
    // Intermediate Variables
    c[0] = block[0] + block[3];
    c[1] = block[2] + block[0];
    c[2] = block[3] - block[2];
    c[3] = kvz_g_iT_DST7_4[1] * block[1];


    coeff[0 * line] = (kvz_g_iT_DST7_4[3] * c[0] + kvz_g_iT_DST7_4[2] * c[1] + c[3] + rnd_factor) >> shift;
    coeff[1 * line] = (kvz_g_iT_DST7_4[1] * (block[0] - block[2] - block[3]) + rnd_factor) >> shift;
    coeff[2 * line] = (kvz_g_iT_DST7_4[3] * c[2] + kvz_g_iT_DST7_4[2] * c[0] - c[3] + rnd_factor) >> shift;
    coeff[3 * line] = (kvz_g_iT_DST7_4[3] * c[1] - kvz_g_iT_DST7_4[2] * c[2] - c[3] + rnd_factor) >> shift;


    block += 4;
    coeff++;
  }

}

static void fastInverseDST7_B4(const int16_t* coeff, int16_t* block, int32_t shift) {
  int32_t i;
  int32_t rnd_factor = 1 << (shift - 1);
  int32_t c[4];
  const int32_t line = 4;  // for square blocks

  for (i = 0; i < line; i++) {
    // Intermediate Variables

    c[0] = coeff[0 * line] + coeff[2 * line];
    c[1] = coeff[2 * line] + coeff[3 * line];
    c[2] = coeff[0 * line] - coeff[3 * line];
    c[3] = kvz_g_iT_DST7_4[2] * coeff[1 * line];


    block[0] = (short)CLIP(-32768, 32767, (kvz_g_iT_DST7_4[0] * c[0] + kvz_g_iT_DST7_4[1] * c[1] + c[3] + rnd_factor) >> shift);
    block[1] = (short)CLIP(-32768, 32767, (kvz_g_iT_DST7_4[1] * c[2] - kvz_g_iT_DST7_4[0] * c[1] + c[3] + rnd_factor) >> shift);
    block[2] = (short)CLIP(-32768, 32767, (kvz_g_iT_DST7_4[2] * (coeff[0 * line] - coeff[2 * line] + coeff[3 * line]) + rnd_factor) >> shift);

    block[3] = (short)CLIP(-32768, 32767, (kvz_g_iT_DST7_4[1] * c[0] + kvz_g_iT_DST7_4[0] * c[2] - c[3] + rnd_factor) >> shift);

    block += 4;
    coeff++;
  }

}

/*
static void fastForwardDST1_B4(const int16_t *block, int16_t *coeff, int32_t shift) {
  int32_t i;
  int32_t rnd_factor = 1 << (shift - 1);
  int32_t E[2], O[2];
  const int32_t line = 4;  // for square blocks

  for (i = 0; i < line; i++) {
    // E and O
    E[0] = block[0] + block[3];
    O[0] = block[0] - block[3];
    E[1] = block[1] + block[2];
    O[1] = block[1] - block[2];

    coeff[0] = (E[0] * kvz_g_iT_DST1_4[0] + E[1] * kvz_g_iT_DST1_4[1] + rnd_factor) >> shift;
    coeff[line] = (O[0] * kvz_g_iT_DST1_4[1] + O[1] * kvz_g_iT_DST1_4[0] + rnd_factor) >> shift;
    coeff[2 * line] = (E[0] * kvz_g_iT_DST1_4[1] - E[1] * kvz_g_iT_DST1_4[0] + rnd_factor) >> shift;
    coeff[3 * line] = (O[0] * kvz_g_iT_DST1_4[0] - O[1] * kvz_g_iT_DST1_4[1] + rnd_factor) >> shift;

    block += 4;
    coeff++;
  }

}


static void fastInverseDST1_B4(const int16_t *coeff, int16_t *block, int32_t shift) {
  int32_t i;
  int32_t rnd_factor = 1 << (shift - 1);
  int32_t E[2], O[2];
  const int32_t line = 4;  // for square blocks

  short kvz_g_iT_DST1_4[16] = { 190,308,308,190,
    308,190,-190,-308,
    308,-190,-190,308,
    190,-308,308,-190 };


  for (i = 0; i < line; i++) {
    // E and O

    E[0] = coeff[0 * line] + coeff[3 * line];
    O[0] = coeff[0 * line] - coeff[3 * line];
    E[1] = coeff[1 * line] + coeff[2 * line];
    O[1] = coeff[1 * line] - coeff[2 * line];


    block[0] = (short)CLIP(-32768, 32767, (E[0] * kvz_g_iT_DST1_4[0] + E[1] * kvz_g_iT_DST1_4[1] + rnd_factor) >> shift);
    block[1] = (short)CLIP(-32768, 32767, (O[0] * kvz_g_iT_DST1_4[1] + O[1] * kvz_g_iT_DST1_4[0] + rnd_factor) >> shift);
    block[2] = (short)CLIP(-32768, 32767, (E[0] * kvz_g_iT_DST1_4[1] - E[1] * kvz_g_iT_DST1_4[0] + rnd_factor) >> shift);
    block[3] = (short)CLIP(-32768, 32767, (O[0] * kvz_g_iT_DST1_4[0] - O[1] * kvz_g_iT_DST1_4[1] + rnd_factor) >> shift);

    block += 4;
    coeff++;

  }
}
*/

static void fastForwardDCT8_B4(const int16_t* block, int16_t* coeff, int32_t shift) {
  int32_t i;
  int32_t rnd_factor = 1 << (shift - 1);
  int32_t c[4];
  const int32_t line = 4;  // for square blocks

  for (i = 0; i < line; i++) {
    // Intermediate Variables
    c[0] = block[0] + block[3];
    c[1] = block[2] + block[0];
    c[2] = block[3] - block[2];
    c[3] = kvz_g_iT_DCT8_4[1] * block[1];


    coeff[0 * line] = (kvz_g_iT_DCT8_4[3] * c[0] + kvz_g_iT_DCT8_4[2] * c[1] + c[3] + rnd_factor) >> shift;
    coeff[1 * line] = (kvz_g_iT_DCT8_4[1] * (block[0] - block[2] - block[3]) + rnd_factor) >> shift;
    coeff[2 * line] = (kvz_g_iT_DCT8_4[3] * c[2] + kvz_g_iT_DCT8_4[2] * c[0] - c[3] + rnd_factor) >> shift;
    coeff[3 * line] = (kvz_g_iT_DCT8_4[3] * c[1] - kvz_g_iT_DCT8_4[2] * c[2] - c[3] + rnd_factor) >> shift;


    block += 4;
    coeff++;
  }
}



static void fastInverseDCT8_B4(const int16_t* coeff, int16_t* block, int32_t shift) {
  int32_t i;
  int32_t rnd_factor = 1 << (shift - 1);
  int32_t c[4];
  const int32_t line = 4;  // for square blocks

  //for (i=0; i<line-iSkipLine; i++)
  for (i = 0; i < line; i++) {
    // Intermediate Variables

    c[0] = coeff[0 * line] + coeff[3 * line];
    c[1] = coeff[2 * line] + coeff[0 * line];
    c[2] = coeff[3 * line] - coeff[2 * line];
    c[3] = kvz_g_iT_DCT8_4[1] * coeff[1 * line];


    block[0] = (kvz_g_iT_DCT8_4[3] * c[0] + kvz_g_iT_DCT8_4[2] * c[1] + c[3] + rnd_factor) >> shift;

    block[1] = (kvz_g_iT_DCT8_4[1] * (coeff[0 * line] - coeff[2 * line] - coeff[3 * line]) + rnd_factor) >> shift;
    block[2] = (kvz_g_iT_DCT8_4[3] * c[2] + kvz_g_iT_DCT8_4[2] * c[0] - c[3] + rnd_factor) >> shift;
    block[3] = (kvz_g_iT_DCT8_4[3] * c[1] - kvz_g_iT_DCT8_4[2] * c[2] - c[3] + rnd_factor) >> shift;

    block += 4;
    coeff++;
  }

}


#define DCT_EMT_NXN_GENERIC(t, n) \
static void fastForward ## t ## _B ## n (const int16_t *block, int16_t *coeff, int32_t shift) {\
  int32_t i, j, k, iSum;\
  int32_t rnd_factor = 1 << (shift - 1);\
  int16_t *pcoef;\
  const int16_t *piT;\
  const int32_t line = n;  /* for square blocks */ \
  for (i = 0; i < line; i++) {\
    piT = kvz_g_iT_ ## t ## _ ## n ;\
    pcoef = coeff;\
    for (j = 0; j < n; j++) {\
      iSum = 0;\
      for (k = 0; k < n; k++) {\
        iSum += block[k] * piT[k];\
      }\
      pcoef[i] = (iSum + rnd_factor) >> shift;\
      pcoef += line;\
      piT += n;\
    }\
    block += n;\
  }\
}\


#define IDCT_EMT_NXN_GENERIC(t, n) \
static void fastInverse ## t ## _B ## n (const int16_t *coeff, int16_t *block, int32_t shift) { \
\
  int32_t i, j, k, iSum; \
  int32_t rnd_factor = 1 << (shift - 1); \
  const int32_t line = n ;  /* for square blocks */  \
  for (i = 0; i < line; i++) { \
    for (j = 0; j < n; j++) {\
      iSum = 0;\
      for (k = 0; k < n; k++) {\
        iSum += coeff[k*line] * kvz_g_iT_ ## t ## _ ## n [k * n + j];\
      }\
      block[j] = (int16_t)CLIP(-32768, 32767, (iSum + rnd_factor) >> shift);\
    }\
    block += n;\
    coeff++;\
  }\
}

// DCT 8
IDCT_EMT_NXN_GENERIC(DCT8, 8);
IDCT_EMT_NXN_GENERIC(DCT8, 16);
IDCT_EMT_NXN_GENERIC(DCT8, 32);

DCT_EMT_NXN_GENERIC(DCT8, 8);
DCT_EMT_NXN_GENERIC(DCT8, 16);
DCT_EMT_NXN_GENERIC(DCT8, 32);
/*
// DCT 5
IDCT_EMT_NXN_GENERIC(DCT5, 4);
IDCT_EMT_NXN_GENERIC(DCT5, 8);
IDCT_EMT_NXN_GENERIC(DCT5, 16);
IDCT_EMT_NXN_GENERIC(DCT5, 32);

DCT_EMT_NXN_GENERIC(DCT5, 4);
DCT_EMT_NXN_GENERIC(DCT5, 8);
DCT_EMT_NXN_GENERIC(DCT5, 16);
DCT_EMT_NXN_GENERIC(DCT5, 32);

// DST 1
IDCT_EMT_NXN_GENERIC(DST1, 8);
IDCT_EMT_NXN_GENERIC(DST1, 16);
IDCT_EMT_NXN_GENERIC(DST1, 32);

DCT_EMT_NXN_GENERIC(DST1, 8);
DCT_EMT_NXN_GENERIC(DST1, 16);
DCT_EMT_NXN_GENERIC(DST1, 32);
*/
// DST 7
IDCT_EMT_NXN_GENERIC(DST7, 8);
IDCT_EMT_NXN_GENERIC(DST7, 16);
IDCT_EMT_NXN_GENERIC(DST7, 32);

DCT_EMT_NXN_GENERIC(DST7, 8);
DCT_EMT_NXN_GENERIC(DST7, 16);
DCT_EMT_NXN_GENERIC(DST7, 32);


typedef void partial_tr_func(const int16_t*, int16_t*, int32_t);

// ToDo: Enable EMT 2x2 and 64x64 transforms
static partial_tr_func* dct_table[3][6] = {
  { /*fastForwardDCT2_B2*/NULL, fastForwardDCT2_B4, fastForwardDCT2_B8, fastForwardDCT2_B16, fastForwardDCT2_B32, NULL/*fastForwardDCT2_B64*/ },
  { NULL,               fastForwardDCT8_B4, fastForwardDCT8_B8, fastForwardDCT8_B16, fastForwardDCT8_B32, NULL },
  { NULL,               fastForwardDST7_B4, fastForwardDST7_B8, fastForwardDST7_B16, fastForwardDST7_B32, NULL },
};

static partial_tr_func* idct_table[3][6] = {
  { NULL/*fastInverseDCT2_B2*/, fastInverseDCT2_B4, fastInverseDCT2_B8, fastInverseDCT2_B16, fastInverseDCT2_B32, NULL/*fastInverseDCT2_B64*/ },
  { NULL,               fastInverseDCT8_B4, fastInverseDCT8_B8, fastInverseDCT8_B16, fastInverseDCT8_B32, NULL },
  { NULL,               fastInverseDST7_B4, fastInverseDST7_B8, fastInverseDST7_B16, fastInverseDST7_B32, NULL },
};


//EMT transform tags
typedef enum tr_type_t {
  DCT2 = 0,
  DCT8 = 1,
  DST7 = 2,
  NUM_TRANS_TYPE = 3,
  DCT2_EMT = 4
} tr_type_t;

static const tr_type_t emt_subset_intra[3][2] = { { DST7, DCT8 }, { DST7, DCT8 }, { DST7, DCT8 } };
static const tr_type_t emt_subset_inter[2] = { DCT8, DST7 };

static const int intra_mode_to_emt_subset_ver[67] =
{//0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66
   2, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0
};

static const int intra_mode_to_emt_subset_hor[67] =
{//0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66
   2, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0
};


static INLINE void get_tr_type(
  int8_t width,
  color_t color,
  const cu_info_t* tu,
  tr_type_t* hor_out,
  tr_type_t* ver_out) {
  if (tu->type == CU_INTRA) {
    if (width == 4 && color == COLOR_Y) {
      *hor_out = *ver_out = DST7;
    }
    else {
      *hor_out = *ver_out = DCT2;
    }

  }
  else if (tu->emt == 0 || color != COLOR_Y) {
    *hor_out = *ver_out = DCT2;

  }
  else {
    int index_hor = tu->tr_idx & 1;
    int index_ver = tu->tr_idx >> 1;
    *hor_out = emt_subset_inter[index_hor];
    *ver_out = emt_subset_inter[index_ver];
  }
}


static void emt_dct_generic(
  int8_t bitdepth,
  color_t color,
  const cu_info_t* tu,
  int8_t width,
  const int16_t* input,
  int16_t* output) {
  tr_type_t type_hor;
  tr_type_t type_ver;

  get_tr_type(width, color, tu, &type_hor, &type_ver);

  const int log2_width_minus2 = kvz_g_convert_to_bit[width];

  partial_tr_func* dct_hor = dct_table[type_hor][log2_width_minus2];
  partial_tr_func* dct_ver = dct_table[type_ver][log2_width_minus2];

  int16_t tmp[32 * 32];
  int32_t shift_1st = log2_width_minus2 + 3 + (bitdepth - 8);
  int32_t shift_2nd = log2_width_minus2 + 10;

  dct_hor(input, tmp, shift_1st);
  dct_ver(tmp, output, shift_2nd);
}


static void emt_idct_generic(
  int8_t bitdepth,
  color_t color,
  const cu_info_t* tu,
  int8_t width,
  const int16_t* input,
  int16_t* output) {
  tr_type_t type_hor;
  tr_type_t type_ver;

  get_tr_type(width, color, tu, &type_hor, &type_ver);

  const int log2_width_minus2 = kvz_g_convert_to_bit[width];

  partial_tr_func* idct_hor = idct_table[type_hor][log2_width_minus2];
  partial_tr_func* idct_ver = idct_table[type_ver][log2_width_minus2];

  int16_t tmp[32 * 32];
  int32_t shift_1st = 9;
  int32_t shift_2nd = 14 - (bitdepth - 8);

  idct_ver(input, tmp, shift_1st);
  idct_hor(tmp, output, shift_2nd);
}


int kvz_strategy_register_dct_generic(void* opaque, uint8_t bitdepth)
{
  bool success = true;

  success &= kvz_strategyselector_register(opaque, "fast_forward_dst_4x4", "generic", 0, &fast_forward_dst_4x4_generic);

  success &= kvz_strategyselector_register(opaque, "dct_4x4", "generic", 0, &dct_4x4_generic);
  success &= kvz_strategyselector_register(opaque, "dct_8x8", "generic", 0, &dct_8x8_generic);
  success &= kvz_strategyselector_register(opaque, "dct_16x16", "generic", 0, &dct_16x16_generic);
  success &= kvz_strategyselector_register(opaque, "dct_32x32", "generic", 0, &dct_32x32_generic);

  success &= kvz_strategyselector_register(opaque, "fast_inverse_dst_4x4", "generic", 0, &fast_inverse_dst_4x4_generic);

  success &= kvz_strategyselector_register(opaque, "idct_4x4", "generic", 0, &idct_4x4_generic);
  success &= kvz_strategyselector_register(opaque, "idct_8x8", "generic", 0, &idct_8x8_generic);
  success &= kvz_strategyselector_register(opaque, "idct_16x16", "generic", 0, &idct_16x16_generic);
  success &= kvz_strategyselector_register(opaque, "idct_32x32", "generic", 0, &idct_32x32_generic);

  success &= kvz_strategyselector_register(opaque, "emt_dct", "generic", 0, &emt_dct_generic);
  success &= kvz_strategyselector_register(opaque, "emt_idct", "generic", 0, &emt_idct_generic);

  return success;
}
